<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marketing Ops â€” btcpredictor.io</title>
<meta name="robots" content="noindex, nofollow">
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='15' fill='%230d0d0d'/%3E%3Ctext x='50' y='72' font-size='70' text-anchor='middle' fill='%2300ff88' font-family='Arial'%3E%E2%82%BF%3C/text%3E%3C/svg%3E">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:      #0a0a0f;
    --bg2:     #0d0d15;
    --bg3:     #111120;
    --bg4:     #161628;
    --orange:  #f7931a;
    --cyan:    #00d4ff;
    --green:   #00ff88;
    --red:     #ff4466;
    --yellow:  #ffd700;
    --purple:  #a855f7;
    --text:    #e8e0d0;
    --muted:   rgba(232,224,208,0.45);
    --dim:     rgba(232,224,208,0.2);
    --border:  rgba(232,224,208,0.07);
    --border-o: rgba(247,147,26,0.2);
    --border-c: rgba(0,212,255,0.2);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    line-height: 1.6;
    padding-top: 52px;
    overflow-x: hidden;
    min-height: 100vh;
  }

  /* â”€â”€ GNAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .gnav {
    position: fixed; width: 100%; top: 0; z-index: 1000;
    height: 52px; background: rgba(10,10,15,.97);
    backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid rgba(247,147,26,.12);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 28px;
  }
  .gnav-logo {
    display: flex; align-items: center; gap: 9px;
    text-decoration: none; color: #fff;
    font-size: 11px; font-weight: 700; letter-spacing: .18em;
    text-transform: uppercase; font-family: 'JetBrains Mono', monospace;
  }
  .gnav-pulse {
    width: 7px; height: 7px; border-radius: 50%;
    background: #00ff88; box-shadow: 0 0 8px #00ff88; flex-shrink: 0;
    animation: gnavPulse 2s ease-in-out infinite;
  }
  @keyframes gnavPulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(.85)} }
  .gnav-links {
    display: flex; flex-direction: column; gap: 0; list-style: none;
    margin: 0; padding: 16px 0; position: fixed; top: 52px; right: 0; bottom: 0;
    width: 240px; background: rgba(10,10,15,.99);
    border-left: 1px solid rgba(247,147,26,.15); z-index: 999;
    transform: translateX(110%); transition: transform .28s cubic-bezier(.4,0,.2,1);
    overflow-y: auto;
  }
  .gnav-links.gnav-open { transform: translateX(0); }
  .gnav-links a {
    text-decoration: none; color: rgba(255,255,255,.45);
    font-size: 10px; letter-spacing: .14em; text-transform: uppercase;
    padding: 13px 24px; display: block;
    transition: color .18s, background .18s;
    font-family: 'JetBrains Mono', monospace;
  }
  .gnav-links a:hover { color: #fff; background: rgba(255,255,255,.05); }
  .gnav-links a.gnav-active { color: rgba(255,255,255,.9); }
  .gnav-links a.gnav-investors { color: #f7931a; border-left: 2px solid rgba(247,147,26,.4); padding: 13px 22px; }
  .gnav-links a.gnav-investors:hover { background: rgba(247,147,26,.07); border-left-color: rgba(247,147,26,.7); }
  .gnav-links a.gnav-marketing { color: var(--cyan); border-left: 2px solid rgba(0,212,255,.4); padding: 13px 22px; }
  .gnav-links a.gnav-marketing:hover { background: rgba(0,212,255,.07); border-left-color: rgba(0,212,255,.7); }
  .gnav-burger {
    display: flex; align-items: center; justify-content: center;
    background: none; border: 1px solid rgba(255,255,255,.15);
    color: rgba(255,255,255,.7); font-size: 14px; cursor: pointer;
    padding: 5px 9px; border-radius: 3px; transition: border-color .2s;
  }
  .gnav-burger:hover { border-color: rgba(255,255,255,.4); }

  /* â”€â”€ STATUS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .status-bar {
    display: flex; gap: 10px; padding: 14px 24px;
    background: var(--bg2);
    border-bottom: 1px solid var(--border-o);
    flex-wrap: wrap;
  }
  .sw {
    display: flex; align-items: center; gap: 10px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 6px; padding: 10px 16px;
    flex: 1; min-width: 200px;
    transition: border-color .2s;
  }
  .sw:hover { border-color: rgba(247,147,26,.25); }
  .sw-icon { font-size: 16px; flex-shrink: 0; }
  .sw-label { color: var(--muted); font-size: 10px; letter-spacing: .12em; text-transform: uppercase; display: block; }
  .sw-value { color: var(--text); font-size: 13px; font-weight: 500; display: block; }
  .sw-body { display: flex; flex-direction: column; gap: 2px; }
  .dot-ok   { color: var(--green); }
  .dot-err  { color: var(--red); }
  .dot-warn { color: var(--yellow); }
  .dot-load { color: var(--muted); }

  /* â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .tab-nav {
    display: flex; gap: 0; flex-wrap: wrap; justify-content: center;
    border-bottom: 1px solid var(--border);
    padding: 0 24px; background: var(--bg2);
    position: sticky; top: 52px; z-index: 100;
  }
  .tab-btn {
    padding: 14px 18px; cursor: pointer;
    border: none; background: none;
    color: var(--muted); font-family: 'JetBrains Mono', monospace;
    font-size: 11px; letter-spacing: .1em; text-transform: uppercase;
    border-bottom: 2px solid transparent;
    transition: color .2s, border-color .2s;
    white-space: nowrap;
  }
  .tab-btn:hover { color: var(--text); }
  .tab-btn.active { color: var(--orange); border-bottom-color: var(--orange); }

  /* â”€â”€ TAB CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .tab-pane { display: none; padding: 28px 24px 60px; max-width: 860px; margin: 0 auto; }
  .tab-pane.active { display: block; }

  /* â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .section-hdr {
    display: flex; align-items: center; gap: 10px;
    margin-bottom: 20px; padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
  }
  .section-hdr h2 { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; }
  .section-hdr span { color: var(--muted); font-size: 12px; }

  /* â”€â”€ CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .card {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 8px; padding: 16px 20px; margin-bottom: 12px;
  }
  .card-title { font-size: 11px; letter-spacing: .12em; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; }
  .card-value { font-size: 15px; font-weight: 500; color: var(--text); }

  /* â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .schedule-list { display: flex; flex-direction: column; gap: 8px; }
  .sch-item {
    display: flex; align-items: center; gap: 14px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 6px; padding: 12px 16px;
    transition: border-color .2s;
  }
  .sch-item:hover { border-color: rgba(247,147,26,.2); }
  .sch-time { color: var(--orange); font-size: 12px; font-weight: 700; width: 100px; flex-shrink: 0; }
  .sch-chan { font-size: 16px; flex-shrink: 0; }
  .sch-desc { color: var(--text); flex: 1; }
  .sch-type {
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    padding: 2px 8px; border-radius: 3px; flex-shrink: 0;
  }
  .sch-type.auto    { background: rgba(0,255,136,.1); color: var(--green); border: 1px solid rgba(0,255,136,.2); }
  .sch-type.content { background: rgba(247,147,26,.1); color: var(--orange); border: 1px solid rgba(247,147,26,.2); }
  .sch-type.sys     { background: rgba(0,212,255,.1); color: var(--cyan); border: 1px solid rgba(0,212,255,.2); }
  .sch-status-ok  { color: var(--green); font-size: 10px; }
  .sch-status-sch { color: var(--yellow); font-size: 10px; }
  .next-event {
    background: linear-gradient(135deg, rgba(247,147,26,.08), rgba(0,212,255,.05));
    border: 1px solid rgba(247,147,26,.3);
    border-radius: 8px; padding: 14px 18px; margin-bottom: 20px;
    display: flex; align-items: center; gap: 12px;
  }
  .next-event-label { color: var(--muted); font-size: 10px; text-transform: uppercase; letter-spacing: .1em; }
  .next-event-val { color: var(--orange); font-size: 14px; font-weight: 600; }

  /* â”€â”€ CHANNELS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .channels-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 12px; }
  .chan-card {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 8px; padding: 18px 20px;
    display: flex; flex-direction: column; gap: 10px;
    transition: border-color .2s;
  }
  .chan-card:hover { border-color: rgba(247,147,26,.2); }
  .chan-header { display: flex; align-items: center; gap: 10px; }
  .chan-icon { font-size: 24px; }
  .chan-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; }
  .chan-handle { color: var(--muted); font-size: 11px; }
  .chan-stat { display: flex; justify-content: space-between; align-items: center; }
  .chan-stat-label { color: var(--muted); font-size: 11px; }
  .chan-stat-val { font-size: 15px; font-weight: 600; }
  .chan-soon { color: var(--muted); font-size: 11px; font-style: italic; }
  .chan-live { color: var(--green); font-size: 10px; text-transform: uppercase; letter-spacing: .1em; }
  .chan-link { color: var(--cyan); font-size: 11px; text-decoration: none; }
  .chan-link:hover { text-decoration: underline; }

  /* â”€â”€ DONATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .wallet-card {
    background: linear-gradient(135deg, rgba(168,85,247,.08), rgba(0,212,255,.05));
    border: 1px solid rgba(168,85,247,.3);
    border-radius: 8px; padding: 20px 22px; margin-bottom: 20px;
  }
  .wallet-addr {
    font-size: 13px; color: var(--cyan); word-break: break-all;
    margin: 8px 0 12px;
  }
  .wallet-actions { display: flex; gap: 10px; flex-wrap: wrap; }
  .btn-sm {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    padding: 6px 14px; border-radius: 4px; cursor: pointer;
    border: 1px solid; transition: all .2s; text-decoration: none;
    display: inline-block;
  }
  .btn-copy { background: rgba(0,212,255,.08); color: var(--cyan); border-color: rgba(0,212,255,.3); }
  .btn-copy:hover { background: rgba(0,212,255,.15); }
  .btn-scan { background: rgba(168,85,247,.08); color: var(--purple); border-color: rgba(168,85,247,.3); }
  .btn-scan:hover { background: rgba(168,85,247,.15); }
  .badge-pub {
    display: inline-flex; align-items: center; gap: 5px;
    font-size: 10px; text-transform: uppercase; letter-spacing: .1em;
    padding: 3px 10px; border-radius: 3px;
  }
  .badge-pub.ok  { background: rgba(0,255,136,.1); color: var(--green); border: 1px solid rgba(0,255,136,.2); }
  .badge-pub.err { background: rgba(255,68,102,.1); color: var(--red); border: 1px solid rgba(255,68,102,.2); }
  .tx-list { display: flex; flex-direction: column; gap: 8px; }
  .tx-item {
    display: flex; align-items: center; gap: 14px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 6px; padding: 10px 14px;
  }
  .tx-hash { color: var(--cyan); font-size: 11px; flex: 1; }
  .tx-val { color: var(--green); font-size: 13px; font-weight: 600; white-space: nowrap; }
  .tx-date { color: var(--muted); font-size: 11px; white-space: nowrap; }
  .tx-empty { color: var(--muted); font-style: italic; padding: 20px; text-align: center; }
  .stat-row { display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 20px; }
  .stat-box {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 6px; padding: 12px 18px; flex: 1; min-width: 120px;
  }
  .stat-box-label { color: var(--muted); font-size: 10px; text-transform: uppercase; letter-spacing: .1em; margin-bottom: 4px; }
  .stat-box-val { font-size: 18px; font-weight: 700; }

  /* â”€â”€ AI AGENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .agent-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 12px; }
  .agent-card {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 8px; padding: 18px 20px;
    display: flex; flex-direction: column; gap: 10px;
  }
  .agent-card.live { border-color: rgba(0,255,136,.25); }
  .agent-card.building { border-color: rgba(247,147,26,.2); }
  .agent-card.concept { border-color: rgba(168,85,247,.2); }
  .agent-name { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700; }
  .agent-desc { color: var(--muted); font-size: 12px; line-height: 1.5; }
  .agent-status {
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    padding: 2px 8px; border-radius: 3px; align-self: flex-start;
  }
  .agent-status.live     { background: rgba(0,255,136,.1); color: var(--green); border: 1px solid rgba(0,255,136,.2); }
  .agent-status.building { background: rgba(247,147,26,.1); color: var(--orange); border: 1px solid rgba(247,147,26,.2); }
  .agent-status.concept  { background: rgba(168,85,247,.1); color: var(--purple); border: 1px solid rgba(168,85,247,.2); }
  .contract-box {
    background: var(--bg4); border: 1px solid rgba(0,212,255,.2);
    border-radius: 8px; padding: 16px 20px; margin-bottom: 20px;
  }
  .contract-box .label { color: var(--muted); font-size: 10px; text-transform: uppercase; letter-spacing: .12em; margin-bottom: 6px; }
  .contract-addr { color: var(--cyan); font-size: 12px; word-break: break-all; margin-bottom: 10px; }
  .contract-stats { display: flex; gap: 16px; flex-wrap: wrap; }
  .c-stat { display: flex; flex-direction: column; gap: 2px; }
  .c-stat-label { color: var(--muted); font-size: 10px; text-transform: uppercase; }
  .c-stat-val { color: var(--text); font-size: 14px; font-weight: 600; }
  .marketplace-tease {
    background: linear-gradient(135deg, rgba(168,85,247,.08), rgba(0,212,255,.05));
    border: 1px solid rgba(168,85,247,.25); border-radius: 8px; padding: 24px;
    text-align: center; margin-top: 8px;
  }
  .marketplace-tease h3 { font-family: 'Syne', sans-serif; font-size: 16px; margin-bottom: 8px; color: var(--purple); }
  .marketplace-tease p { color: var(--muted); font-size: 12px; line-height: 1.7; }

  /* â”€â”€ SEO CHIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .seo-chips { display: flex; gap: 6px; flex-wrap: wrap; }
  .seo-chip {
    font-size: 10px; text-transform: uppercase; letter-spacing: .1em;
    padding: 3px 9px; border-radius: 3px;
  }
  .seo-chip.ok  { background: rgba(0,255,136,.1); color: var(--green); border: 1px solid rgba(0,255,136,.2); }
  .seo-chip.err { background: rgba(255,68,102,.1); color: var(--red); border: 1px solid rgba(255,68,102,.2); }

  /* â”€â”€ ON-CHAIN / PROOF CHAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .proof-hero {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 28px; align-items: center;
    background: linear-gradient(135deg, rgba(0,212,255,.05), rgba(168,85,247,.05));
    border: 1px solid rgba(0,212,255,.2);
    border-radius: 10px; padding: 24px 28px; margin-bottom: 24px;
  }
  @media(max-width:600px){ .proof-hero { grid-template-columns:1fr; } }
  .gauge-wrap { display:flex; flex-direction:column; align-items:center; gap:6px; }
  .gauge-label { font-size:9px; text-transform:uppercase; letter-spacing:.14em; color:var(--muted); }
  .proof-meta { display:flex; flex-direction:column; gap:14px; }
  .proof-meta-title { font-family:'Syne',sans-serif; font-size:16px; font-weight:700; color:var(--cyan); }
  .proof-stats-row { display:flex; gap:20px; flex-wrap:wrap; }
  .pstat { display:flex; flex-direction:column; gap:2px; }
  .pstat-label { font-size:10px; text-transform:uppercase; letter-spacing:.1em; color:var(--muted); }
  .pstat-val { font-size:18px; font-weight:700; }

  /* pipeline */
  .pipeline {
    display:flex; align-items:center; gap:0;
    background:var(--bg3); border:1px solid var(--border);
    border-radius:8px; padding:16px 20px; margin-bottom:20px;
    overflow-x:auto; flex-wrap:nowrap;
  }
  .pipe-node {
    display:flex; flex-direction:column; align-items:center; gap:6px;
    min-width:80px; text-align:center; flex-shrink:0;
  }
  .pipe-icon { font-size:22px; }
  .pipe-name { font-size:9px; text-transform:uppercase; letter-spacing:.1em; color:var(--muted); }
  .pipe-led {
    width:8px; height:8px; border-radius:50%; flex-shrink:0;
    box-shadow:0 0 6px;
  }
  .pipe-led.ok     { background:var(--green); box-shadow:0 0 6px var(--green); animation:ledPulse 2s ease-in-out infinite; }
  .pipe-led.warn   { background:var(--yellow); box-shadow:0 0 6px var(--yellow); }
  .pipe-led.err    { background:var(--red); box-shadow:0 0 6px var(--red); }
  .pipe-led.dim    { background:var(--muted); box-shadow:none; }
  @keyframes ledPulse { 0%,100%{opacity:1} 50%{opacity:.4} }
  .pipe-arrow {
    color:var(--border); font-size:16px; padding:0 6px; flex-shrink:0;
    align-self:flex-start; margin-top:12px;
  }
  .pipe-chain {
    font-size:9px; text-transform:uppercase; letter-spacing:.08em;
    padding:2px 6px; border-radius:3px; margin-top:2px;
  }
  .pipe-chain.onchain  { background:rgba(168,85,247,.15); color:var(--purple); border:1px solid rgba(168,85,247,.3); }
  .pipe-chain.offchain { background:rgba(232,224,208,.05); color:var(--muted); border:1px solid var(--border); }

  /* audit ledger */
  .ledger-header {
    display:grid;
    grid-template-columns: 56px 52px 64px 90px 90px 72px auto;
    gap:0; font-size:9px; text-transform:uppercase; letter-spacing:.1em;
    color:var(--muted); padding:8px 14px; border-bottom:1px solid var(--border);
  }
  .ledger-row {
    display:grid;
    grid-template-columns: 56px 52px 64px 90px 90px 72px auto;
    gap:0; padding:10px 14px;
    border-bottom:1px solid var(--border);
    transition:background .15s;
    align-items:center;
  }
  .ledger-row:hover { background:rgba(255,255,255,.02); }
  .ledger-row:last-child { border-bottom:none; }
  @media(max-width:700px){
    .ledger-header,.ledger-row { grid-template-columns:50px 44px 56px 1fr; }
    .ledger-cell.hide-mobile { display:none; }
  }
  .ledger-wrap {
    background:var(--bg3); border:1px solid var(--border);
    border-radius:8px; overflow:hidden; margin-bottom:20px;
  }
  .ledger-cell { font-size:12px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .proof-badge {
    font-size:9px; text-transform:uppercase; letter-spacing:.08em;
    padding:2px 7px; border-radius:3px; white-space:nowrap; font-weight:600;
  }
  .proof-badge.full     { background:rgba(0,255,136,.12); color:var(--green); border:1px solid rgba(0,255,136,.25); }
  .proof-badge.pending  { background:rgba(255,215,0,.1); color:var(--yellow); border:1px solid rgba(255,215,0,.2); }
  .proof-badge.missing  { background:rgba(255,68,102,.1); color:var(--red); border:1px solid rgba(255,68,102,.2); }
  .proof-badge.noproof  { background:rgba(255,255,255,.04); color:var(--muted); border:1px solid var(--border); }
  .tx-link { color:var(--cyan); text-decoration:none; font-size:11px; font-family:'JetBrains Mono',monospace; }
  .tx-link:hover { text-decoration:underline; }
  .no-tx { color:var(--muted); font-size:11px; }
  .dir-up   { color:var(--green); font-weight:700; }
  .dir-down { color:var(--red); font-weight:700; }
  .pnl-pos  { color:var(--green); }
  .pnl-neg  { color:var(--red); }

  /* â”€â”€ NEWS FEED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .news-grid { display:flex; flex-direction:column; gap:10px; }
  .news-item {
    display:grid; grid-template-columns:auto 1fr;
    gap:12px; align-items:start;
    background:var(--bg3); border:1px solid var(--border);
    border-radius:8px; padding:14px 16px;
    transition:border-color .2s;
  }
  .news-item:hover { border-color:rgba(247,147,26,.2); }
  .news-source-badge {
    font-size:9px; text-transform:uppercase; letter-spacing:.1em;
    padding:2px 8px; border-radius:3px; white-space:nowrap;
    background:rgba(0,212,255,.08); color:var(--cyan);
    border:1px solid rgba(0,212,255,.2); font-weight:600;
    margin-top:2px;
  }
  .news-title {
    font-size:13px; font-weight:500; color:var(--text); line-height:1.4;
    margin-bottom:5px;
  }
  .news-title a { color:inherit; text-decoration:none; }
  .news-title a:hover { color:var(--orange); text-decoration:underline; }
  .news-meta { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .news-date { color:var(--muted); font-size:10px; }
  .news-summary { color:var(--muted); font-size:11px; line-height:1.5; margin-top:4px; }
  .news-source-dot {
    width:6px; height:6px; border-radius:50%; flex-shrink:0; margin-top:5px;
  }
  .source-coindesk    { background:#f7931a; }
  .source-cointelegraph { background:#00d4ff; }
  .source-btcmag      { background:#ff9500; }
  .source-decrypt     { background:#a855f7; }
  .news-filters { display:flex; gap:6px; flex-wrap:wrap; margin-bottom:16px; }
  .filter-btn {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    letter-spacing:.08em; padding:4px 12px; border-radius:3px; cursor:pointer;
    background:var(--bg3); border:1px solid var(--border); color:var(--muted);
    transition:all .15s;
  }
  .filter-btn:hover, .filter-btn.active { color:var(--text); border-color:rgba(247,147,26,.4); background:rgba(247,147,26,.06); }

  /* â”€â”€ PED â€” Piano Editoriale â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .ped-header { display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:10px; margin-bottom:14px; }
  .ped-header h2 { font-family:'Syne',sans-serif; font-size:15px; font-weight:700; }
  .ped-header span { color:var(--muted); font-size:11px; }
  .btn-new-post {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    letter-spacing:.1em; padding:6px 14px; border-radius:4px; cursor:pointer;
    background:rgba(247,147,26,.1); border:1px solid rgba(247,147,26,.35);
    color:var(--orange); transition:all .2s;
  }
  .btn-new-post:hover { background:rgba(247,147,26,.18); }
  .ped-apikey-bar {
    background:rgba(0,212,255,.06); border:1px solid rgba(0,212,255,.2);
    border-radius:6px; padding:10px 14px; margin-bottom:14px;
    display:flex; align-items:center; gap:10px; flex-wrap:wrap;
  }
  .ped-apikey-bar input {
    font-family:'JetBrains Mono',monospace; font-size:11px;
    background:rgba(0,0,0,.3); border:1px solid rgba(0,212,255,.25);
    color:var(--cyan); border-radius:3px; padding:5px 10px; flex:1; min-width:200px; outline:none;
  }
  .ped-apikey-bar input::placeholder { color:rgba(0,212,255,.4); }
  .btn-apikey-save {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    padding:5px 12px; border-radius:3px; cursor:pointer;
    background:rgba(0,212,255,.1); border:1px solid rgba(0,212,255,.3); color:var(--cyan); transition:all .2s;
  }
  .btn-apikey-save:hover { background:rgba(0,212,255,.2); }
  .post-cards { display:flex; flex-direction:column; gap:10px; }
  .post-card {
    background:var(--bg3); border:1px solid var(--border);
    border-radius:8px; padding:14px 16px;
    transition:border-color .2s;
  }
  .post-card:hover { border-color:rgba(247,147,26,.2); }
  .post-card-meta {
    display:flex; align-items:center; gap:8px; margin-bottom:8px; flex-wrap:wrap;
  }
  .post-date-badge {
    font-size:10px; text-transform:uppercase; letter-spacing:.1em;
    padding:2px 8px; border-radius:3px;
    background:rgba(247,147,26,.1); color:var(--orange); border:1px solid rgba(247,147,26,.25);
  }
  .post-chan-badge {
    font-size:10px; text-transform:uppercase; letter-spacing:.08em;
    padding:2px 7px; border-radius:3px;
  }
  .post-chan-tg   { background:rgba(0,212,255,.08); color:var(--cyan); border:1px solid rgba(0,212,255,.2); }
  .post-chan-x    { background:rgba(232,224,208,.05); color:var(--muted); border:1px solid var(--border); }
  .post-chan-li   { background:rgba(0,119,181,.1); color:#4fa8d1; border:1px solid rgba(0,119,181,.3); }
  .post-chan-rd   { background:rgba(255,69,0,.08); color:#ff6b35; border:1px solid rgba(255,69,0,.25); }
  .post-title { font-family:'Syne',sans-serif; font-size:13px; font-weight:700; margin-bottom:4px; }
  .post-text {
    color:var(--muted); font-size:11px; line-height:1.6;
    white-space:pre-wrap; max-height:80px; overflow:hidden;
    position:relative;
  }
  .post-text.expanded { max-height:none; }
  .post-text-toggle { color:var(--orange); font-size:10px; cursor:pointer; margin-top:4px; display:inline-block; }
  .post-actions { display:flex; gap:6px; flex-wrap:wrap; margin-top:10px; }
  .btn-pub {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    letter-spacing:.08em; padding:5px 11px; border-radius:3px; cursor:pointer;
    border:1px solid; transition:all .2s;
  }
  .btn-pub-copy  { background:rgba(232,224,208,.05); color:var(--muted); border-color:var(--border); }
  .btn-pub-copy:hover { color:var(--text); border-color:rgba(232,224,208,.25); }
  .btn-pub-tg    { background:rgba(0,212,255,.08); color:var(--cyan); border-color:rgba(0,212,255,.3); }
  .btn-pub-tg:hover { background:rgba(0,212,255,.18); }
  .btn-pub-x     { background:rgba(232,224,208,.04); color:rgba(232,224,208,.3); border-color:rgba(232,224,208,.08); cursor:not-allowed; }
  .btn-pub-li    { background:rgba(0,119,181,.05); color:rgba(74,168,209,.3); border-color:rgba(0,119,181,.1); cursor:not-allowed; }
  .btn-pub-rd    { background:rgba(255,69,0,.05); color:rgba(255,107,53,.3); border-color:rgba(255,69,0,.1); cursor:not-allowed; }
  .btn-pub-del   { background:rgba(255,68,102,.06); color:rgba(255,68,102,.4); border-color:rgba(255,68,102,.15); cursor:pointer; }
  .btn-pub-del:hover { color:var(--red); border-color:rgba(255,68,102,.35); }
  .post-photo-thumb { display:flex; align-items:center; gap:10px; margin-bottom:10px; padding:8px 10px; background:rgba(0,255,136,.04); border:1px solid rgba(0,255,136,.1); border-radius:6px; }
  .post-photo-thumb img { width:56px; height:56px; object-fit:cover; border-radius:4px; border:1px solid rgba(0,255,136,.15); }
  .post-photo-name { font-size:11px; color:var(--green); opacity:.7; font-family:monospace; }
  .ped-new-form {
    background:var(--bg4); border:1px solid rgba(247,147,26,.25);
    border-radius:8px; padding:16px 18px; margin-bottom:14px;
  }
  .ped-new-form h3 { font-family:'Syne',sans-serif; font-size:13px; font-weight:700; margin-bottom:12px; color:var(--orange); }
  .ped-form-row { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
  .ped-form-row input, .ped-form-row select {
    font-family:'JetBrains Mono',monospace; font-size:11px;
    background:rgba(0,0,0,.3); border:1px solid var(--border);
    color:var(--text); border-radius:3px; padding:6px 10px; outline:none;
    transition:border-color .2s;
  }
  .ped-form-row input:focus, .ped-form-row select:focus { border-color:rgba(247,147,26,.4); }
  .ped-form-row select option { background:#0d0d15; }
  .ped-form-row input[type=text] { flex:1; min-width:160px; }
  .ped-form-row input[type=datetime-local] { min-width:180px; }
  .ped-form-textarea {
    font-family:'JetBrains Mono',monospace; font-size:11px;
    background:rgba(0,0,0,.3); border:1px solid var(--border);
    color:var(--text); border-radius:3px; padding:8px 10px; outline:none;
    width:100%; min-height:90px; resize:vertical; margin-bottom:10px; line-height:1.5;
    transition:border-color .2s;
  }
  .ped-form-textarea:focus { border-color:rgba(247,147,26,.4); }
  .ped-form-actions { display:flex; gap:8px; }
  .btn-form-save {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    padding:6px 16px; border-radius:3px; cursor:pointer;
    background:rgba(247,147,26,.15); border:1px solid rgba(247,147,26,.4); color:var(--orange);
    transition:all .2s;
  }
  .btn-form-save:hover { background:rgba(247,147,26,.25); }
  .btn-form-cancel {
    font-family:'JetBrains Mono',monospace; font-size:10px; text-transform:uppercase;
    padding:6px 14px; border-radius:3px; cursor:pointer;
    background:transparent; border:1px solid var(--border); color:var(--muted);
    transition:all .2s;
  }
  .btn-form-cancel:hover { color:var(--text); }
  .ped-empty {
    text-align:center; color:var(--muted); font-size:12px; font-style:italic;
    padding:24px; background:var(--bg3); border:1px dashed var(--border); border-radius:8px;
  }
  .pub-toast {
    position:fixed; bottom:24px; right:24px; z-index:9999;
    background:rgba(10,10,15,.97); border:1px solid rgba(0,255,136,.35);
    border-radius:6px; padding:10px 16px; font-size:12px; color:var(--green);
    box-shadow:0 4px 24px rgba(0,0,0,.5);
    transform:translateY(80px); opacity:0; transition:all .3s cubic-bezier(.4,0,.2,1);
    pointer-events:none;
  }
  .pub-toast.show { transform:translateY(0); opacity:1; }
  .pub-toast.err { border-color:rgba(255,68,102,.35); color:var(--red); }

  /* â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .mono { font-family: 'JetBrains Mono', monospace; }
  .loading { color: var(--muted); font-style: italic; }
  .error-note { color: var(--red); font-size: 11px; }
  .refresh-btn {
    font-family: 'JetBrains Mono', monospace; font-size: 10px; text-transform: uppercase;
    letter-spacing: .1em; padding: 5px 12px; border-radius: 4px; cursor: pointer;
    background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.12);
    color: var(--muted); transition: all .2s;
  }
  .refresh-btn:hover { color: var(--text); border-color: rgba(255,255,255,.25); }
  .page-header {
    padding: 22px 24px 0;
    max-width: 860px; margin: 0 auto;
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 10px;
  }
  .page-header h1 { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; }
  .page-header .sub { color: var(--muted); font-size: 12px; }
  .last-updated { color: var(--dim); font-size: 11px; }
  hr.divider { border: none; border-top: 1px solid var(--border); margin: 18px 0; }

  @media (max-width: 600px) {
    .status-bar { padding: 10px 12px; gap: 8px; }
    .sw { min-width: 140px; padding: 8px 12px; }
    .tab-pane { padding: 16px 12px 60px; }
    .tab-btn { padding: 12px 12px; font-size: 10px; }
    .page-header { padding: 16px 12px 0; }
  }
</style>
</head>
<body>

<!-- â”€â”€ GNAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav class="gnav">
  <a href="https://btcpredictor.io" class="gnav-logo"><span class="gnav-pulse"></span>BTCPREDICTOR.IO</a>
  <button class="gnav-burger" id="gnavBurger" onclick="toggleGnav()" aria-label="Menu">â˜°</button>
</nav>
<ul class="gnav-links" id="gnavLinks">
  <li><a href="https://btcpredictor.io/dashboard">Dashboard</a></li>
  <li><a href="https://btcpredictor.io/xgboost-spiegato">How It Works</a></li>
  <li><a href="https://btcpredictor.io/investors" class="gnav-investors">Investors</a></li>
  <li><a href="https://btcpredictor.io/contributors">Contributors</a></li>
  <li><a href="https://btcpredictor.io/aureo" style="color:#C9A84C;border:1px solid rgba(201,168,76,.3);padding:5px 14px;border-radius:3px;">AUREO</a></li>
  <li><a href="https://btcpredictor.io/marketing" class="gnav-marketing">Marketing Ops</a></li>
</ul>
<div id="gnavBackdrop" onclick="toggleGnav()" style="display:none;position:fixed;inset:0;z-index:998;background:rgba(0,0,0,0.45);"></div>

<!-- â”€â”€ STATUS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="status-bar" id="statusBar">
  <div class="sw">
    <div class="sw-icon">ğŸ¦Š</div>
    <div class="sw-body">
      <span class="sw-label">Wallet on-site</span>
      <span class="sw-value dot-load" id="swWallet">caricamentoâ€¦</span>
    </div>
  </div>
  <div class="sw">
    <div class="sw-icon">ğŸ”</div>
    <div class="sw-body">
      <span class="sw-label">SEO-AI</span>
      <span class="sw-value dot-load" id="swSeo">caricamentoâ€¦</span>
    </div>
  </div>
  <div class="sw">
    <div class="sw-icon">ğŸ“¡</div>
    <div class="sw-body">
      <span class="sw-label">Telegram Members</span>
      <span class="sw-value dot-load" id="swTg">caricamentoâ€¦</span>
    </div>
  </div>
  <div class="sw">
    <div class="sw-icon">ğŸ§ </div>
    <div class="sw-body">
      <span class="sw-label">Last Retrain</span>
      <span class="sw-value dot-load" id="swRetrain">caricamentoâ€¦</span>
    </div>
  </div>
</div>

<!-- â”€â”€ PAGE HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="page-header">
  <div>
    <h1>ğŸ™ Marketing Ops</h1>
    <div class="sub">Build-in-public dashboard â€” btcpredictor.io</div>
  </div>
  <div style="display:flex;align-items:center;gap:10px;">
    <span class="last-updated" id="lastUpdated">â€”</span>
    <button class="refresh-btn" onclick="loadStats()">â†» Refresh</button>
  </div>
</div>

<!-- â”€â”€ TAB NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="tab-nav">
  <button class="tab-btn active" onclick="showTab('calendar')" id="tab-btn-calendar">ğŸ“… Calendar</button>
  <button class="tab-btn" onclick="showTab('channels')" id="tab-btn-channels">ğŸ“¡ Channels</button>
  <button class="tab-btn" onclick="showTab('donations')" id="tab-btn-donations">ğŸ¤‘ Donations</button>
  <button class="tab-btn" onclick="showTab('agents')" id="tab-btn-agents">ğŸ¤– AI Agents</button>
  <button class="tab-btn" onclick="showTab('onchain')" id="tab-btn-onchain">â›“ Proof Chain</button>
  <button class="tab-btn" onclick="showTab('news')" id="tab-btn-news">ğŸ“° News</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 1 â€” CALENDAR                                            -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane active" id="pane-calendar">

  <div class="next-event">
    <span style="font-size:20px;">â±</span>
    <div>
      <div class="next-event-label">Prossimo evento</div>
      <div class="next-event-val" id="nextEvent">Calcoloâ€¦</div>
    </div>
  </div>

  <div class="section-hdr">
    <h2>Schedule Ricorrente</h2>
    <span>UTC â€” timezone base del bot</span>
  </div>

  <div class="schedule-list">
    <div class="sch-item">
      <div class="sch-time">Ogni 15 min</div>
      <div class="sch-chan">ğŸ¤–</div>
      <div class="sch-desc">Position monitor â€” wf08 BTC_Position_Monitor<br><span style="color:var(--muted);font-size:11px;">Controlla posizioni aperte, trigger rescue se necessario</span></div>
      <span class="sch-type auto">auto</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">Ogni ora</div>
      <div class="sch-chan">ğŸ¤–</div>
      <div class="sch-desc">System watchdog â€” wf06 BTC_System_Watchdog<br><span style="color:var(--muted);font-size:11px;">Health check infrastruttura, alert se wf critici offline</span></div>
      <span class="sch-type sys">system</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">00:00 / 08:00 / 16:00</div>
      <div class="sch-chan">ğŸ“Š</div>
      <div class="sch-desc">Funding rate settlement (Binance perp)<br><span style="color:var(--muted);font-size:11px;">Pattern: pressione buy post-settlement quando funding era positivo</span></div>
      <span class="sch-type sys">market</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">Daily 07:00</div>
      <div class="sch-chan">ğŸ“¬</div>
      <div class="sch-desc">Morning Telegram update â€” wf04 BTC_Talker<br><span style="color:var(--muted);font-size:11px;">Report giornaliero su @BTCPredictorBot</span></div>
      <span class="sch-type content">content</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">Daily 08:00</div>
      <div class="sch-chan">ğŸ“£</div>
      <div class="sch-desc">Social content â€” wf11 BTC_Channel_Content<br><span style="color:var(--muted);font-size:11px;">Generazione contenuti social con AI â†’ pubblicazione automatica</span></div>
      <span class="sch-type content">content</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">VenerdÃ¬ (expiry)</div>
      <div class="sch-chan">âš¡</div>
      <div class="sch-desc">Options expiry BTC/ETH â€” finestra ad alta volatilitÃ <br><span style="color:var(--muted);font-size:11px;">Bias contrarian: spesso spike pre-expiry + reversal post-settlement</span></div>
      <span class="sch-type market">market</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">Dom 03:00</div>
      <div class="sch-chan">ğŸ§ </div>
      <div class="sch-desc">XGBoost retrain â€” /force-retrain automatico<br><span style="color:var(--muted);font-size:11px;">Retrain su dataset aggiornato â†’ push model su Railway â†’ reload</span></div>
      <span class="sch-type sys">ML retrain</span>
    </div>
    <div class="sch-item">
      <div class="sch-time">Dom 09:30</div>
      <div class="sch-chan">ğŸ’¾</div>
      <div class="sch-desc">n8n VPS backup â€” launchd Mac<br><span style="color:var(--muted);font-size:11px;">Backup SQLite dei workflow da VPS Hostinger</span></div>
      <span class="sch-type sys">system</span>
    </div>
  </div>

  <hr class="divider">

  <!-- PED â€” Piano Editoriale Digitale -->
  <div class="ped-header">
    <div>
      <h2>ğŸ“‹ Piano Editoriale</h2>
      <span>Bozze post â€” copia testo o pubblica direttamente sui canali</span>
    </div>
    <button class="btn-new-post" onclick="pedToggleNewForm()">+ Nuovo Post</button>
  </div>

  <!-- API Key setup bar (nascosta se giÃ  salvata) -->
  <div class="ped-apikey-bar" id="pedApikeyBar" style="display:none;">
    <span style="color:var(--cyan);font-size:11px;">ğŸ”‘ API Key</span>
    <input type="password" id="pedApikeyInput" placeholder="Inserisci BOT_API_KEY per pubblicare su Telegramâ€¦">
    <button class="btn-apikey-save" onclick="pedSaveApiKey()">Salva</button>
    <span id="pedApikeyStatus" style="font-size:11px;color:var(--muted);"></span>
  </div>

  <!-- New Post Form (hidden by default) -->
  <div class="ped-new-form" id="pedNewForm" style="display:none;">
    <h3>âœï¸ Nuovo Post</h3>
    <div class="ped-form-row">
      <input type="text" id="pedFormTitle" placeholder="Titolo (interno)â€¦" style="flex:1;">
      <input type="datetime-local" id="pedFormDate">
      <select id="pedFormChannel">
        <option value="tg">âœˆï¸ Telegram</option>
        <option value="all">ğŸ“¡ Tutti i canali</option>
        <option value="x">ğ• X / Twitter</option>
        <option value="li">ğŸ’¼ LinkedIn</option>
        <option value="rd">ğŸ¤– Reddit</option>
      </select>
    </div>
    <textarea class="ped-form-textarea" id="pedFormText" placeholder="Testo del postâ€¦ (max 4096 char per Telegram)"></textarea>
    <div class="ped-form-actions">
      <button class="btn-form-save" onclick="pedSaveNewPost()">ğŸ’¾ Salva Bozza</button>
      <button class="btn-form-cancel" onclick="pedToggleNewForm()">Annulla</button>
    </div>
  </div>

  <!-- Posts list -->
  <div class="post-cards" id="pedPostsList"></div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 2 â€” CHANNELS                                            -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane" id="pane-channels">

  <div class="section-hdr">
    <h2>Canali di Distribuzione</h2>
    <span>metriche live dove disponibili</span>
  </div>

  <div class="channels-grid">

    <!-- Telegram -->
    <div class="chan-card" style="border-color:rgba(0,212,255,.25);">
      <div class="chan-header">
        <div class="chan-icon">âœˆï¸</div>
        <div>
          <div class="chan-name">Telegram</div>
          <div class="chan-handle">@BTCPredictorBot</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">Members</span>
        <span class="chan-stat-val dot-ok" id="tgMemberCount">â€”</span>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <span class="chan-live">â— live</span>
        <a href="https://t.me/BTCPredictorBot" target="_blank" class="chan-link">t.me/BTCPredictorBot â†—</a>
      </div>
      <div style="color:var(--muted);font-size:11px;">Canale pubblico build-in-public storytelling. Canale principale.</div>
    </div>

    <!-- X / Twitter -->
    <div class="chan-card">
      <div class="chan-header">
        <div class="chan-icon">ğ•</div>
        <div>
          <div class="chan-name">X / Twitter</div>
          <div class="chan-handle">@btcpredictor_io</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">Followers</span>
        <span class="chan-stat-val" style="color:var(--muted);">â€”</span>
      </div>
      <div><span class="chan-soon">Integration coming soon</span></div>
      <div style="color:var(--muted);font-size:11px;">Thread tecnici + performance update settimanale via wf09A.</div>
    </div>

    <!-- LinkedIn -->
    <div class="chan-card">
      <div class="chan-header">
        <div class="chan-icon">ğŸ’¼</div>
        <div>
          <div class="chan-name">LinkedIn</div>
          <div class="chan-handle">Mattia Calastri</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">Connections</span>
        <span class="chan-stat-val" style="color:var(--muted);">â€”</span>
      </div>
      <div><span class="chan-soon">Integration coming soon</span></div>
      <div style="color:var(--muted);font-size:11px;">Angolo investor + professional audience. Target: fintech, crypto.</div>
    </div>

    <!-- Reddit -->
    <div class="chan-card">
      <div class="chan-header">
        <div class="chan-icon">ğŸ¤˜</div>
        <div>
          <div class="chan-name">Reddit</div>
          <div class="chan-handle">r/algotrading</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">Post karma</span>
        <span class="chan-stat-val" style="color:var(--muted);">â€”</span>
      </div>
      <div><span class="chan-soon">Integration coming soon</span></div>
      <div style="color:var(--muted);font-size:11px;">r/algotrading, r/BitcoinMarkets â€” community engagement.</div>
    </div>

    <!-- btcpredictor.io -->
    <div class="chan-card" style="border-color:rgba(247,147,26,.2);">
      <div class="chan-header">
        <div class="chan-icon">ğŸŒ</div>
        <div>
          <div class="chan-name">btcpredictor.io</div>
          <div class="chan-handle">sito principale</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">SEO Status</span>
        <span class="chan-stat-val" id="chanSeoVal">â€”</span>
      </div>
      <div>
        <a href="https://btcpredictor.io" target="_blank" class="chan-link">btcpredictor.io â†—</a>
      </div>
      <div style="color:var(--muted);font-size:11px;">Organic traffic + email leads via Satoshi widget.</div>
    </div>

    <!-- AUREO -->
    <div class="chan-card" style="border-color:rgba(201,168,76,.25);">
      <div class="chan-header">
        <div class="chan-icon">ğŸ©</div>
        <div>
          <div class="chan-name">AUREO</div>
          <div class="chan-handle">@aureo.io</div>
        </div>
      </div>
      <div class="chan-stat">
        <span class="chan-stat-label">Status</span>
        <span class="chan-stat-val" style="color:#C9A84C;">Building</span>
      </div>
      <div>
        <a href="https://btcpredictor.io/aureo" target="_blank" class="chan-link" style="color:#C9A84C;">btcpredictor.io/aureo â†—</a>
      </div>
      <div style="color:var(--muted);font-size:11px;">Educazione finanziaria IT gratuita on-chain. Per Aspera ad Astra.</div>
    </div>

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 3 â€” DONATIONS                                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane" id="pane-donations">

  <div class="section-hdr">
    <h2>Wallet Donazioni</h2>
    <span>Polygon PoS</span>
  </div>

  <div class="wallet-card">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;">
      <div style="font-size:11px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);">Polygon PoS Wallet</div>
      <span class="badge-pub ok" id="walletBadge">âœ… Published on site</span>
    </div>
    <div class="wallet-addr" id="walletAddrDisplay">0x7Ac896F18ce52a0520dA49C3129520f7B70d51f0</div>
    <div class="wallet-actions">
      <button class="btn-sm btn-copy" onclick="copyWallet()">ğŸ“‹ Copia</button>
      <a class="btn-sm btn-scan" href="https://polygonscan.com/address/0x7Ac896F18ce52a0520dA49C3129520f7B70d51f0" target="_blank">ğŸ” Polygonscan â†—</a>
    </div>
  </div>

  <div style="background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:16px 20px;margin-bottom:20px;">
    <div style="color:var(--muted);font-size:11px;margin-bottom:10px;">
      Verifica storico transazioni direttamente su Polygonscan â€” nessuna API key necessaria.
    </div>
    <a class="btn-sm btn-scan" href="https://polygonscan.com/address/0x7Ac896F18ce52a0520dA49C3129520f7B70d51f0" target="_blank" style="text-decoration:none;">ğŸ” Vedi su Polygonscan â†—</a>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 4 â€” AI AGENTS                                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane" id="pane-agents">

  <div class="section-hdr">
    <h2>On-Chain Audit Contract</h2>
    <span>BTCBotAudit.sol â€” Polygon PoS</span>
  </div>

  <div class="contract-box">
    <div class="label">Contract Address</div>
    <div class="contract-addr">0xe4661F7dB62644951Eb1F9Fd23DB90e647833a55</div>
    <div style="display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap;">
      <a class="btn-sm btn-copy" href="https://polygonscan.com/address/0xe4661F7dB62644951Eb1F9Fd23DB90e647833a55" target="_blank" style="text-decoration:none;">ğŸ” Polygonscan â†—</a>
    </div>
    <div class="contract-stats">
      <div class="c-stat">
        <span class="c-stat-label">Rete</span>
        <span class="c-stat-val" style="color:var(--purple);">Polygon PoS</span>
      </div>
      <div class="c-stat">
        <span class="c-stat-label">FinalitÃ </span>
        <span class="c-stat-val" style="color:var(--green);">~2s</span>
      </div>
      <div class="c-stat">
        <span class="c-stat-label">Funzioni</span>
        <span class="c-stat-val">commitPrediction / resolvePrediction</span>
      </div>
      <div class="c-stat">
        <span class="c-stat-label">Gas/tx</span>
        <span class="c-stat-val" style="color:var(--green);">&lt; $0.01</span>
      </div>
    </div>
  </div>

  <div class="section-hdr">
    <h2>AI Agents Attivi</h2>
    <span>17 workflow n8n Â· VPS Hostinger Â· ogni ciclo ~15 min</span>
  </div>

  <!-- LIVE agents -->
  <div style="font-size:10px;text-transform:uppercase;letter-spacing:.12em;color:var(--green);margin-bottom:8px;">â— Core Engine â€” in produzione</div>
  <div class="agent-grid" style="margin-bottom:18px;">
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ§  Brain â€” wf01B</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">AI prediction engine. LLM (Gemini Flash) + XGBoost dual-gate. Ogni segnale commesso on-chain su Polygon <em>prima</em> del fill Kraken.</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(168,85,247,.1);color:var(--purple);border:1px solid rgba(168,85,247,.2);">LLM</span>
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(0,255,136,.08);color:var(--green);border:1px solid rgba(0,255,136,.15);">XGBoost</span>
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(0,212,255,.08);color:var(--cyan);border:1px solid rgba(0,212,255,.2);">On-Chain</span>
      </div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ“Š Inputs â€” wf01A</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Fetch 20+ feature: RSI 14/50, CVD 6h, Fear&amp;Greed, funding rate, L/S ratio, orderbook imbalance, macro calendar. Formatta JSON per LLM.</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(247,147,26,.08);color:var(--orange);border:1px solid rgba(247,147,26,.2);">20+ features</span>
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(0,212,255,.08);color:var(--cyan);border:1px solid rgba(0,212,255,.2);">Binance API</span>
      </div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ” Trade Checker â€” wf02</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Rescue PENDING, resolve on-chain, calcola PnL reale post-fee. Circuit breaker attivo: 3 loss consecutive â†’ bot in pausa automatica.</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(255,68,102,.08);color:var(--red);border:1px solid rgba(255,68,102,.2);">Circuit Breaker</span>
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(0,212,255,.08);color:var(--cyan);border:1px solid rgba(0,212,255,.2);">On-Chain</span>
      </div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ›¡ Position Monitor â€” wf08</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Ogni 3 minuti: verifica posizioni aperte su Kraken Futures. Trigger rescue se SL/TP raggiunto o timeout 30 min.</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(0,255,136,.08);color:var(--green);border:1px solid rgba(0,255,136,.15);">ogni 3 min</span>
      </div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ“¬ Talker â€” wf04</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Report giornaliero 07:00 UTC su @BTCPredictorBot. WR del giorno, PnL, segnali recenti, equity corrente.</div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ¤– Commander â€” wf07</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Telegram bot conversazionale. 67 nodi, inline buttons. Comandi: health, balance, position, pause/resume, close. Solo owner.</div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ“£ Channel Content â€” wf11</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Genera e pubblica contenuti storytelling build-in-public su @BTCPredictorBot. Tone: tecnico, autentico, no hype.</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        <span style="font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(168,85,247,.1);color:var(--purple);border:1px solid rgba(168,85,247,.2);">Gemini Flash</span>
      </div>
    </div>
    <div class="agent-card live">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ”” Sentry Handler â€” wf10</div>
        <span class="agent-status live">live</span>
      </div>
      <div class="agent-desc">Webhook Sentry â†’ AI analisi errore (Gemini) â†’ DM Mattia + task autonomo. FirstSeenEvent + RegressionEvent â‰¥ error.</div>
    </div>
  </div>

  <!-- BUILDING agents -->
  <div style="font-size:10px;text-transform:uppercase;letter-spacing:.12em;color:var(--orange);margin-bottom:8px;">â— In Costruzione â€” Q2 2026</div>
  <div class="agent-grid" style="margin-bottom:18px;">
    <div class="agent-card building">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ”® Regime Detector</div>
        <span class="agent-status building">building</span>
      </div>
      <div class="agent-desc">Labelling automatico trend/ranging/volatile con volatilitÃ  storica 4h normalizzata. Feature P1 per XGBoost â€” il WR cambia radicalmente per regime.</div>
    </div>
    <div class="agent-card building">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ§® Signal Audit On-Chain</div>
        <span class="agent-status building">building</span>
      </div>
      <div class="agent-desc"><code>commitSignal()</code> per ghost e SKIP. Ogni segnale â€” non solo i BET â€” sarÃ  verificabile on-chain. Dataset di training auditabile pubblicamente.</div>
    </div>
  </div>

  <!-- CONCEPT agents -->
  <div style="font-size:10px;text-transform:uppercase;letter-spacing:.12em;color:var(--purple);margin-bottom:8px;">â—‹ Research â€” Concept Q3 2026</div>
  <div class="agent-grid" style="margin-bottom:18px;">
    <div class="agent-card concept" style="border-color:rgba(255,215,0,.25);">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name" style="color:var(--yellow);">ğŸ¦ Whale Alert Agent</div>
        <span class="agent-status concept" style="background:rgba(255,215,0,.1);color:var(--yellow);border-color:rgba(255,215,0,.25);">concept</span>
      </div>
      <div class="agent-desc">Monitor real-time transazioni &gt;1000 BTC su Whale Alert API. Ogni movimento whale Ã¨ un pre-segnale di volatilitÃ  con un lag misurabile di 2â€“8 minuti. Feature ad alto information gain per il dual-gate.</div>
      <div style="margin-top:6px;font-size:10px;color:rgba(255,215,0,.6);font-style:italic;">â†’ Whale moves BTC price. Il modello puÃ² vederlo prima del mercato.</div>
    </div>
    <div class="agent-card concept">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ“ SOPR / MVRV Agent</div>
        <span class="agent-status concept">concept</span>
      </div>
      <div class="agent-desc">Metriche on-chain: SOPR &lt;1 = capitolation, &gt;1 = profit-taking. MVRV Z-score &gt;7 = zona peak storica. Filtro di regime macro per evitare segnali in zone di esaurimento strutturale.</div>
    </div>
    <div class="agent-card concept">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸŒŠ Liquidation Wall Agent</div>
        <span class="agent-status concept">concept</span>
      </div>
      <div class="agent-desc">Mappa in real-time i livelli di liquidazione massima dai perp Binance/OKX. Il prezzo si muove verso le liquidation walls â€” identificarle in anticipo Ã¨ un edge diretto.</div>
    </div>
    <div class="agent-card concept">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;">
        <div class="agent-name">ğŸ“¡ Exchange Flow Agent</div>
        <span class="agent-status concept">concept</span>
      </div>
      <div class="agent-desc">Exchange netflow on-chain: inflow netto = selling pressure imminente, outflow = accumulation. Segnale contrarian affidabile su finestre 4hâ€“24h.</div>
    </div>
  </div>

  <div class="marketplace-tease">
    <div style="font-size:28px;margin-bottom:10px;">ğŸ™</div>
    <h3>Agent Marketplace â€” Coming Soon</h3>
    <p>
      Un marketplace on-chain dove sviluppatori terzi possono deployare agenti specializzati
      (sentiment, on-chain, cross-asset) che si integrano nel dual-gate.<br>
      Ogni agente Ã¨ un modulo verificabile on-chain con revenue share automatico.<br><br>
      <span style="color:var(--purple);">Status: concept design Â· ETA: Q3 2026</span>
    </p>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 5 â€” PROOF CHAIN                                         -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane" id="pane-onchain">

  <!-- HERO: gauge + stats -->
  <div class="proof-hero">
    <div class="gauge-wrap">
      <svg viewBox="0 0 120 120" width="110" height="110" style="overflow:visible">
        <!-- track -->
        <circle cx="60" cy="60" r="48" fill="none" stroke="rgba(255,255,255,.07)" stroke-width="9"/>
        <!-- glow ring -->
        <circle cx="60" cy="60" r="48" fill="none" stroke="rgba(0,212,255,.1)" stroke-width="14"/>
        <!-- progress arc â€” dashoffset set by JS -->
        <circle id="gaugeArc" cx="60" cy="60" r="48" fill="none"
          stroke="url(#gaugeGrad)" stroke-width="9"
          stroke-dasharray="301.6" stroke-dashoffset="301.6"
          stroke-linecap="round"
          transform="rotate(-90 60 60)"
          style="transition:stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1)"/>
        <defs>
          <linearGradient id="gaugeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#00d4ff"/>
            <stop offset="100%" stop-color="#00ff88"/>
          </linearGradient>
        </defs>
        <!-- center text -->
        <text id="gaugePct" x="60" y="56" text-anchor="middle"
          font-size="24" fill="#e8e0d0" font-family="JetBrains Mono,monospace" font-weight="700">â€”</text>
        <text x="60" y="70" text-anchor="middle"
          font-size="8" fill="rgba(232,224,208,.4)" font-family="JetBrains Mono,monospace"
          text-transform="uppercase" letter-spacing="2">integrity</text>
      </svg>
      <div class="gauge-label">proof chain score</div>
    </div>

    <div class="proof-meta">
      <div>
        <div class="proof-meta-title">â›“ On-Chain Audit Integrity</div>
        <div style="color:var(--muted);font-size:11px;margin-top:4px;">
          Ogni prediction ha un <span style="color:var(--purple)">commit</span> on-chain PRIMA del fill Kraken
          e un <span style="color:var(--cyan)">resolve</span> DOPO la chiusura. Immutabile, verificabile, trustless.
        </div>
      </div>
      <div class="proof-stats-row">
        <div class="pstat">
          <span class="pstat-label">Commits</span>
          <span class="pstat-val" id="pcCommits" style="color:var(--purple);">â€”</span>
        </div>
        <div class="pstat">
          <span class="pstat-label">Resolves</span>
          <span class="pstat-val" id="pcResolves" style="color:var(--cyan);">â€”</span>
        </div>
        <div class="pstat">
          <span class="pstat-label">Full Proof</span>
          <span class="pstat-val" id="pcFull" style="color:var(--green);">â€”</span>
        </div>
        <div class="pstat">
          <span class="pstat-label">Ultimo commit</span>
          <span class="pstat-val" id="pcLastCommit" style="color:var(--text);font-size:13px;">â€”</span>
        </div>
      </div>
      <div id="pcLiveBadge" style="display:none;align-items:center;gap:6px;">
        <span style="width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 6px var(--green);animation:ledPulse 2s ease-in-out infinite;display:inline-block;"></span>
        <span style="font-size:11px;color:var(--green);">Sistema attivo â€” audit registrati nelle ultime 24h</span>
      </div>
    </div>
  </div>

  <!-- PIPELINE FLOW -->
  <div class="section-hdr">
    <h2>Pipeline Audit Flow</h2>
    <span>ogni step verificabile on-chain</span>
  </div>

  <div class="pipeline">
    <div class="pipe-node">
      <div class="pipe-icon">ğŸ“Š</div>
      <div class="pipe-led ok" id="pipeInputs"></div>
      <div class="pipe-name">wf01A<br>Inputs</div>
      <div class="pipe-chain offchain">off-chain</div>
    </div>
    <div class="pipe-arrow">â†’</div>
    <div class="pipe-node">
      <div class="pipe-icon">ğŸ§ </div>
      <div class="pipe-led ok" id="pipeBrain"></div>
      <div class="pipe-name">wf01B<br>AI Decision</div>
      <div class="pipe-chain offchain">off-chain</div>
    </div>
    <div class="pipe-arrow">â†’</div>
    <div class="pipe-node">
      <div class="pipe-icon">â›“</div>
      <div class="pipe-led" id="pipeCommit" style="background:var(--purple);box-shadow:0 0 6px var(--purple);animation:ledPulse 2s ease-in-out infinite;"></div>
      <div class="pipe-name">COMMIT<br>Polygon</div>
      <div class="pipe-chain onchain">on-chain</div>
    </div>
    <div class="pipe-arrow">â†’</div>
    <div class="pipe-node">
      <div class="pipe-icon">âš¡</div>
      <div class="pipe-led ok" id="pipeFill"></div>
      <div class="pipe-name">Kraken<br>Fill</div>
      <div class="pipe-chain offchain">off-chain</div>
    </div>
    <div class="pipe-arrow">â†’</div>
    <div class="pipe-node">
      <div class="pipe-icon">ğŸ”</div>
      <div class="pipe-led ok" id="pipeMonitor"></div>
      <div class="pipe-name">wf08<br>Monitor</div>
      <div class="pipe-chain offchain">off-chain</div>
    </div>
    <div class="pipe-arrow">â†’</div>
    <div class="pipe-node">
      <div class="pipe-icon">â›“</div>
      <div class="pipe-led" id="pipeResolve" style="background:var(--cyan);box-shadow:0 0 6px var(--cyan);animation:ledPulse 2s ease-in-out infinite;"></div>
      <div class="pipe-name">RESOLVE<br>Polygon</div>
      <div class="pipe-chain onchain">on-chain</div>
    </div>
  </div>

  <!-- AUDIT LEDGER -->
  <div class="section-hdr" style="margin-top:18px;">
    <h2>Audit Ledger</h2>
    <span id="ledgerMeta">ultime 30 bet con proof status</span>
  </div>

  <div class="ledger-wrap">
    <div class="ledger-header">
      <div>#</div>
      <div>Dir</div>
      <div>Conf</div>
      <div class="hide-mobile">Commit TX</div>
      <div class="hide-mobile">Resolve TX</div>
      <div class="hide-mobile">PnL</div>
      <div>Status</div>
    </div>
    <div id="auditLedger">
      <div style="padding:24px;text-align:center;color:var(--muted);font-style:italic;">
        Caricamento audit trailâ€¦
      </div>
    </div>
  </div>

  <!-- CONTRACT INSPECTOR -->
  <div class="section-hdr" style="margin-top:18px;">
    <h2>Contract Inspector</h2>
    <span>BTCBotAudit.sol â€” verifica manuale</span>
  </div>

  <div style="background:var(--bg3);border:1px solid rgba(168,85,247,.2);border-radius:8px;padding:18px 20px;">
    <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:6px;">Contratto</div>
    <div style="color:var(--cyan);font-size:12px;word-break:break-all;margin-bottom:12px;">0xe4661F7dB62644951Eb1F9Fd23DB90e647833a55</div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <a class="btn-sm btn-scan" href="https://polygonscan.com/address/0xe4661F7dB62644951Eb1F9Fd23DB90e647833a55" target="_blank" style="text-decoration:none;">ğŸ” Explorer â†—</a>
      <a class="btn-sm" href="https://polygonscan.com/address/0xe4661F7dB62644951Eb1F9Fd23DB90e647833a55#readContract" target="_blank" style="text-decoration:none;background:rgba(0,255,136,.07);color:var(--green);border:1px solid rgba(0,255,136,.25);">ğŸ“– Read Contract â†—</a>
    </div>
    <div style="margin-top:16px;padding-top:12px;border-top:1px solid var(--border);">
      <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:8px;">Come verificare una prediction</div>
      <div style="color:var(--text);font-size:11px;line-height:1.8;">
        1. Copia il <span style="color:var(--purple)">commit TX hash</span> dalla riga sopra<br>
        2. Cerca su <a href="https://polygonscan.com" target="_blank" style="color:var(--cyan);">polygonscan.com</a> â€” verifica il timestamp<br>
        3. Il timestamp on-chain deve essere <strong>precedente</strong> al fill Kraken<br>
        4. Il <span style="color:var(--cyan)">resolve TX</span> deve matchare l'outcome reale<br>
        5. Impossibile retrodatare: l'hash Ã¨ deterministico e immutabile â›“
      </div>
    </div>
  </div>

  <!-- COSTO RETE DI AGENTI -->
  <div class="section-hdr" style="margin-top:22px;">
    <h2>Costo Rete di Agenti</h2>
    <span>infrastruttura on-chain â€” Polygon PoS</span>
  </div>

  <div style="background:linear-gradient(135deg,rgba(168,85,247,.06),rgba(0,212,255,.04));border:1px solid rgba(168,85,247,.2);border-radius:8px;padding:20px 22px;">
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:16px;margin-bottom:18px;">
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:4px;">Segnali / giorno</div>
        <div style="font-size:20px;font-weight:700;color:var(--text);">~96</div>
        <div style="font-size:10px;color:var(--muted);">1 ciclo ogni 15 min Ã— 24h</div>
      </div>
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:4px;">TX on-chain / segnale</div>
        <div style="font-size:20px;font-weight:700;color:var(--purple);">2</div>
        <div style="font-size:10px;color:var(--muted);">commitPrediction + resolvePrediction</div>
      </div>
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:4px;">Gas / TX</div>
        <div style="font-size:20px;font-weight:700;color:var(--cyan);">~80k</div>
        <div style="font-size:10px;color:var(--muted);">@ 50 Gwei = 0.004 MATIC</div>
      </div>
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:4px;">MATIC / TX</div>
        <div style="font-size:20px;font-weight:700;color:var(--text);">0.004</div>
        <div style="font-size:10px;color:var(--muted);">â‰ˆ $0.0008 @ $0.20/MATIC</div>
      </div>
    </div>
    <div style="border-top:1px solid var(--border);padding-top:14px;">
      <div style="font-size:10px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:10px;">Stima Costo Mensile</div>
      <div style="display:flex;flex-direction:column;gap:6px;">
        <div style="display:flex;justify-content:space-between;align-items:center;font-size:12px;">
          <span style="color:var(--muted);">Solo BET (tasso 15â€“20%): ~576 tx/mese</span>
          <span style="color:var(--green);font-weight:700;">~$0.46 / mese</span>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;font-size:12px;">
          <span style="color:var(--muted);">BET + ghost SKIP: ~5760 tx/mese</span>
          <span style="color:var(--yellow);font-weight:700;">~$4.61 / mese</span>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;font-size:12px;padding-top:6px;border-top:1px solid var(--border);">
          <span style="color:var(--text);font-weight:600;">Scenario attuale (solo BET)</span>
          <span style="color:var(--green);font-size:16px;font-weight:800;">~$0.46 / mese</span>
        </div>
      </div>
      <div style="margin-top:12px;padding:10px 14px;background:rgba(0,255,136,.04);border-radius:5px;border:1px solid rgba(0,255,136,.1);">
        <div style="font-size:11px;color:var(--muted);line-height:1.7;">
          ğŸ’¡ <strong style="color:var(--text);">PerchÃ© Polygon?</strong>
          FinalitÃ  ~2 secondi. Gas irrisorio (&lt;$0.001/tx).
          Ogni prediction Ã¨ immutabile: impossibile retrodatare o modificare un outcome dopo il commit.
          Costo infrastrutturale dell'intera rete di agenti: meno di un caffÃ¨ al mese.
        </div>
      </div>
    </div>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TAB 6 â€” NEWS FEED                                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-pane" id="pane-news">

  <div class="section-hdr">
    <h2>ğŸ“° Crypto News Live</h2>
    <span>stesse sorgenti di wf01A Â· cache 10 min</span>
  </div>

  <div class="news-filters">
    <button class="filter-btn active" onclick="filterNews('all', this)">Tutte</button>
    <button class="filter-btn" onclick="filterNews('CoinDesk', this)">CoinDesk</button>
    <button class="filter-btn" onclick="filterNews('CoinTelegraph', this)">CoinTelegraph</button>
    <button class="filter-btn" onclick="filterNews('Bitcoin Magazine', this)">BTC Mag</button>
    <button class="filter-btn" onclick="filterNews('Decrypt', this)">Decrypt</button>
  </div>

  <div class="news-grid" id="newsList">
    <div style="padding:24px;text-align:center;color:var(--muted);font-style:italic;">
      Caricamento newsâ€¦
    </div>
  </div>

</div>

<script>
/* â”€â”€ GNAV â”€â”€ */
function toggleGnav(){
  var l=document.getElementById('gnavLinks');
  var b=document.getElementById('gnavBackdrop');
  var btn=document.getElementById('gnavBurger');
  var open=l.classList.toggle('gnav-open');
  b.style.display=open?'block':'none';
  btn.textContent=open?'âœ•':'â˜°';
}
document.addEventListener('keydown',function(e){
  if(e.key==='Escape'){
    var l=document.getElementById('gnavLinks');
    if(l&&l.classList.contains('gnav-open'))toggleGnav();
  }
});

/* â”€â”€ TABS â”€â”€ */
var _onchainLoaded = false;
var _newsLoaded    = false;
function showTab(id) {
  document.querySelectorAll('.tab-pane').forEach(function(p){ p.classList.remove('active'); });
  document.querySelectorAll('.tab-btn').forEach(function(b){ b.classList.remove('active'); });
  var pane = document.getElementById('pane-' + id);
  var btn  = document.getElementById('tab-btn-' + id);
  if(pane) pane.classList.add('active');
  if(btn)  btn.classList.add('active');
  if(id === 'onchain' && !_onchainLoaded) { _onchainLoaded = true; loadOnChainAudit(); }
  if(id === 'news'    && !_newsLoaded)    { _newsLoaded    = true; loadNews(); }
}

/* â”€â”€ NEXT EVENT â”€â”€ */
function computeNextEvent() {
  var now = new Date();
  var utcH = now.getUTCHours(), utcM = now.getUTCMinutes(), utcD = now.getUTCDay();
  var events = [
    { label: 'Position monitor (wf08)', minuteOffset: 15 - (now.getUTCMinutes() % 15) },
  ];
  // Daily events
  var daily = [
    { h: 0,  m: 0,  label: 'Funding settlement 00:00 UTC' },
    { h: 7,  m: 0,  label: 'Morning Telegram post (wf04)' },
    { h: 8,  m: 0,  label: 'Social content (wf11)' },
    { h: 8,  m: 0,  label: 'Funding settlement 08:00 UTC' },
    { h: 16, m: 0,  label: 'Funding settlement 16:00 UTC' },
  ];
  var best = null, bestMin = Infinity;
  daily.forEach(function(ev) {
    var diff = (ev.h - utcH) * 60 + (ev.m - utcM);
    if(diff <= 0) diff += 1440;
    if(diff < bestMin) { bestMin = diff; best = ev.label; }
  });
  // Compare with position monitor
  var monMin = 15 - (now.getUTCMinutes() % 15);
  if(monMin < bestMin) { bestMin = monMin; best = 'Position monitor (wf08)'; }
  var h = Math.floor(bestMin / 60), m = bestMin % 60;
  var parts = [];
  if(h > 0) parts.push(h + 'h');
  parts.push(m + 'min');
  document.getElementById('nextEvent').textContent = best + ' â€” tra ' + parts.join(' ');
}
computeNextEvent();

/* â”€â”€ UTILS â”€â”€ */
function truncAddr(addr) {
  if(!addr || addr.length < 16) return addr;
  return addr.slice(0, 8) + 'â€¦' + addr.slice(-6);
}

/* â”€â”€ COPY WALLET â”€â”€ */
function copyWallet() {
  navigator.clipboard.writeText('0x7Ac896F18ce52a0520dA49C3129520f7B70d51f0').then(function() {
    var btn = document.querySelector('.btn-copy');
    if(btn) { btn.textContent = 'âœ… Copiato!'; setTimeout(function(){ btn.textContent = 'ğŸ“‹ Copia'; }, 2000); }
  });
}

/* â”€â”€ LOAD MARKETING STATS â”€â”€ */
function loadStats() {
  document.getElementById('lastUpdated').textContent = 'aggiornamentoâ€¦';
  document.querySelectorAll('.sw-value').forEach(function(el){ el.textContent = 'caricamentoâ€¦'; el.className = 'sw-value dot-load'; });

  fetch('/marketing-stats')
    .then(function(r){ return r.json(); })
    .then(function(data) {
      var now = new Date();
      document.getElementById('lastUpdated').textContent = 'aggiornato ' + now.toLocaleTimeString('it-IT');

      /* â”€â”€ STATUS BAR â”€â”€ */
      // Wallet
      var wallet = data.wallet || {};
      var wEl = document.getElementById('swWallet');
      if(wallet.published_in_site) {
        wEl.textContent = 'âœ… ' + truncAddr(wallet.address);
        wEl.className = 'sw-value dot-ok';
      } else {
        wEl.textContent = 'âŒ Non presente in index.html';
        wEl.className = 'sw-value dot-err';
      }
      var badge = document.getElementById('walletBadge');
      if(badge) {
        badge.textContent = wallet.published_in_site ? 'âœ… Published on site' : 'âŒ Not published';
        badge.className = 'badge-pub ' + (wallet.published_in_site ? 'ok' : 'err');
      }

      // SEO
      var seo = data.seo || {};
      var seoEl = document.getElementById('swSeo');
      var seoKeys = ['og_image','meta_description','json_ld','canonical'];
      var seoLabels = {'og_image':'og:img','meta_description':'meta-desc','json_ld':'JSON-LD','canonical':'canonical'};
      var seoAll = seoKeys.every(function(k){ return seo[k]; });
      if(seoAll) {
        seoEl.textContent = 'âœ… 4/4 pass';
        seoEl.className = 'sw-value dot-ok';
      } else {
        var failed = seoKeys.filter(function(k){ return !seo[k]; }).map(function(k){ return seoLabels[k]; });
        seoEl.textContent = 'âš  fail: ' + failed.join(', ');
        seoEl.className = 'sw-value dot-warn';
      }
      // Channels tab SEO
      var chanSeo = document.getElementById('chanSeoVal');
      if(chanSeo) {
        chanSeo.textContent = seoAll ? 'âœ… 4/4 pass' : 'âš  ' + (4 - Object.keys(seo).filter(function(k){ return seo[k]; }).length) + ' issues';
        chanSeo.className = seoAll ? 'chan-stat-val dot-ok' : 'chan-stat-val dot-warn';
      }
      // SEO chips in donations (hidden â€” could add to channels card)

      // Telegram
      var tgEl = document.getElementById('swTg');
      var tgCount = document.getElementById('tgMemberCount');
      if(data.telegram_members !== null && data.telegram_members !== undefined) {
        var val = data.telegram_members.toLocaleString('it-IT');
        tgEl.textContent = 'ğŸ“¡ ' + val + ' members';
        tgEl.className = 'sw-value dot-ok';
        if(tgCount) { tgCount.textContent = val; }
      } else {
        tgEl.textContent = 'â€” (token mancante)';
        tgEl.className = 'sw-value dot-warn';
        if(tgCount) { tgCount.textContent = 'â€”'; }
      }

      // Retrain â€” mostra progresso verso prossima finestra buona
      var rtEl = document.getElementById('swRetrain');
      var bs = data.bet_stats || {};
      var cleanBets = bs.clean_bets || 0;
      var wins      = bs.wins      || 0;
      var wr        = bs.win_rate_pct;
      // Prossima finestra: ogni 50 clean bets, minimo 50
      var milestone = Math.max(50, Math.ceil((cleanBets + 1) / 50) * 50);
      var remaining = milestone - cleanBets;
      var wrStr = wr !== null && wr !== undefined ? ' Â· WR ' + wr + '%' : '';
      if(cleanBets >= milestone) {
        rtEl.textContent = 'ğŸŸ¢ FINESTRA APERTA â€” ' + cleanBets + ' bet' + wrStr;
        rtEl.className = 'sw-value dot-ok';
      } else if(cleanBets > 0) {
        rtEl.textContent = 'ğŸ§  ' + cleanBets + ' bet' + wrStr + ' Â· âˆ’' + remaining + ' â†’ fin.' + milestone;
        rtEl.className = remaining <= 10 ? 'sw-value dot-ok' : 'sw-value dot-warn';
      } else {
        rtEl.textContent = 'Day 0 â€” 0 bet pulite Â· âˆ’50 â†’ prima finestra';
        rtEl.className = 'sw-value dot-warn';
      }

      /* â”€â”€ DONATIONS TAB: wallet badge only â”€â”€ */
      // tx data rimossa (PolygonScan V1 deprecato, nessuna API key)

    })
    .catch(function(err) {
      document.getElementById('lastUpdated').textContent = 'âš  errore caricamento';
      console.error('marketing-stats error:', err);
    });
}

/* â”€â”€ PROOF CHAIN / ON-CHAIN AUDIT â”€â”€ */
function loadOnChainAudit() {
  fetch('/on-chain-audit')
    .then(function(r){ return r.json(); })
    .then(function(d) {
      if(d.error) { console.warn('on-chain-audit:', d.error); showMaintenanceState(); return; }
      if(d.maintenance_mode) { showMaintenanceState(); return; }

      /* gauge */
      var score = d.integrity_score;
      var gaugePct = document.getElementById('gaugePct');
      var gaugeArc = document.getElementById('gaugeArc');
      if(gaugePct && gaugeArc && score !== null && score !== undefined) {
        var CIRC = 301.6;
        var offset = CIRC * (1 - score / 100);
        gaugePct.textContent = score.toFixed(0) + '%';
        // color by score
        var col = score >= 85 ? 'url(#gaugeGrad)' : score >= 60 ? '#ffd700' : '#ff4466';
        gaugeArc.setAttribute('stroke', col);
        // animate after short delay to let CSS transition fire
        setTimeout(function(){ gaugeArc.setAttribute('stroke-dashoffset', offset.toFixed(1)); }, 120);
      } else if(gaugePct) {
        gaugePct.textContent = 'â€”';
      }

      /* stats */
      function setEl(id, val){ var e=document.getElementById(id); if(e) e.textContent=val; }
      setEl('pcCommits', d.with_commit !== undefined ? d.with_commit : 'â€”');
      setEl('pcResolves', d.with_resolve !== undefined ? d.with_resolve : 'â€”');
      setEl('pcFull', d.with_full_proof !== undefined ? d.with_full_proof : 'â€”');
      if(d.last_commit_at) {
        var dt = new Date(d.last_commit_at);
        setEl('pcLastCommit', dt.toLocaleDateString('it-IT',{day:'2-digit',month:'2-digit'}) +
          ' ' + dt.toLocaleTimeString('it-IT',{hour:'2-digit',minute:'2-digit'}));
        // live badge if last commit < 24h
        var diffH = (Date.now() - dt.getTime()) / 3600000;
        var badge = document.getElementById('pcLiveBadge');
        if(badge && diffH < 24) badge.style.display = 'flex';
      }

      /* pipeline status: if last commit < 4h â†’ green, else warn */
      function pipeStatus(id, ok) {
        var el = document.getElementById(id);
        if(!el) return;
        el.className = 'pipe-led ' + (ok ? 'ok' : 'warn');
      }
      var lastCommitH = d.last_commit_at ? (Date.now() - new Date(d.last_commit_at).getTime()) / 3600000 : 999;
      var botActive = lastCommitH < 4;
      pipeStatus('pipeInputs',  botActive);
      pipeStatus('pipeBrain',   botActive);
      pipeStatus('pipeFill',    botActive);
      pipeStatus('pipeMonitor', botActive);
      if(!botActive) {
        var c = document.getElementById('pipeCommit');
        var rv = document.getElementById('pipeResolve');
        if(c)  { c.style.background='var(--yellow)'; c.style.boxShadow='0 0 6px var(--yellow)'; c.style.animation='none'; }
        if(rv) { rv.style.background='var(--yellow)'; rv.style.boxShadow='0 0 6px var(--yellow)'; rv.style.animation='none'; }
      }

      /* audit ledger */
      var entries = d.entries || [];
      var meta = document.getElementById('ledgerMeta');
      if(meta) meta.textContent = 'ultime ' + entries.length + ' bet Â· proof status live';

      var ledger = document.getElementById('auditLedger');
      if(!ledger) return;
      if(entries.length === 0) {
        ledger.innerHTML = '<div style="padding:20px;text-align:center;color:var(--muted);font-style:italic;">Nessun dato disponibile</div>';
        return;
      }

      var PS_BASE = 'https://polygonscan.com/tx/';
      ledger.innerHTML = entries.map(function(e) {
        var dirClass = e.direction === 'UP' ? 'dir-up' : 'dir-down';
        var dirLabel = e.direction === 'UP' ? 'â†‘ UP' : 'â†“ DN';
        var conf = e.confidence ? (parseFloat(e.confidence)*100).toFixed(0)+'%' : 'â€”';
        var commitCell = e.commit_tx
          ? '<a class="tx-link" href="' + PS_BASE + e.commit_tx + '" target="_blank">' + e.commit_tx.slice(0,8)+'â€¦</a>'
          : '<span class="no-tx">â€”</span>';
        var resolveCell = e.resolve_tx
          ? '<a class="tx-link" href="' + PS_BASE + e.resolve_tx + '" target="_blank">' + e.resolve_tx.slice(0,8)+'â€¦</a>'
          : (e.correct === null ? '<span style="color:var(--yellow);font-size:11px;">â³ open</span>' : '<span class="no-tx">â€”</span>');
        var pnl = e.pnl_usd !== null && e.pnl_usd !== undefined
          ? '<span class="' + (e.pnl_usd >= 0 ? 'pnl-pos' : 'pnl-neg') + '">' +
            (e.pnl_usd >= 0 ? '+' : '') + parseFloat(e.pnl_usd).toFixed(4) + '</span>'
          : '<span style="color:var(--muted);">â€”</span>';

        var badge, badgeClass;
        if(e.status === 'full_proof') {
          badge = 'â›“ Full Proof'; badgeClass = 'full';
        } else if(e.status === 'pending_resolve') {
          badge = 'â³ Pending'; badgeClass = 'pending';
        } else if(e.status === 'missing_resolve') {
          badge = 'âš  No Resolve'; badgeClass = 'missing';
        } else {
          badge = 'â—‹ No Proof'; badgeClass = 'noproof';
        }

        return '<div class="ledger-row">' +
          '<div class="ledger-cell" style="color:var(--muted);">#' + e.id + '</div>' +
          '<div class="ledger-cell ' + dirClass + '">' + dirLabel + '</div>' +
          '<div class="ledger-cell" style="color:var(--text);">' + conf + '</div>' +
          '<div class="ledger-cell hide-mobile">' + commitCell + '</div>' +
          '<div class="ledger-cell hide-mobile">' + resolveCell + '</div>' +
          '<div class="ledger-cell hide-mobile">' + pnl + '</div>' +
          '<div class="ledger-cell"><span class="proof-badge ' + badgeClass + '">' + badge + '</span></div>' +
          '</div>';
      }).join('');
    })
    .catch(function(err){ console.warn('on-chain-audit error:', err); });
}

/* â”€â”€ PROOF CHAIN: EMPTY STATE per bot in pausa â”€â”€ */
function showMaintenanceState() {
  var gaugePct = document.getElementById('gaugePct');
  var gaugeArc = document.getElementById('gaugeArc');
  if(gaugePct) gaugePct.textContent = 'â€”';
  if(gaugeArc) gaugeArc.setAttribute('stroke-dashoffset', '301.6');
  ['pcCommits','pcResolves','pcFull'].forEach(function(id){
    var e = document.getElementById(id); if(e) e.textContent = '0';
  });
  var le = document.getElementById('auditLedger');
  if(le) le.innerHTML = '<div style="padding:28px;text-align:center;">' +
    '<div style="font-size:28px;margin-bottom:10px;">ğŸ”§</div>' +
    '<div style="color:var(--yellow);font-size:13px;font-weight:600;margin-bottom:6px;">Sistema in Manutenzione</div>' +
    '<div style="color:var(--muted);font-size:12px;line-height:1.7;">' +
    'Il bot Ã¨ in pausa dal 28 Feb 2026.<br>' +
    'L\'audit ledger si popolerÃ  automaticamente al go-live (1Â° Marzo).<br>' +
    'Le colonne <span style="color:var(--purple)">onchain_commit_tx / resolve_tx</span> sono giÃ  nel DB âœ“' +
    '</div></div>';
  // pipeline in pausa
  ['pipeInputs','pipeBrain','pipeFill','pipeMonitor'].forEach(function(id){
    var e = document.getElementById(id);
    if(e) { e.className='pipe-led warn'; }
  });
  var c = document.getElementById('pipeCommit');
  var rv = document.getElementById('pipeResolve');
  if(c)  { c.style.background='var(--muted)'; c.style.boxShadow='none'; c.style.animation='none'; }
  if(rv) { rv.style.background='var(--muted)'; rv.style.boxShadow='none'; rv.style.animation='none'; }
}

/* â”€â”€ NEWS FEED â”€â”€ */
var _allNewsItems = [];

function renderNews(filter) {
  var list = document.getElementById('newsList');
  if(!list) return;
  var items = filter && filter !== 'all'
    ? _allNewsItems.filter(function(i){ return i.source === filter; })
    : _allNewsItems;
  if(items.length === 0) {
    list.innerHTML = '<div style="padding:24px;text-align:center;color:var(--muted);font-style:italic;">Nessun articolo disponibile per questo filtro.</div>';
    return;
  }
  var sourceDotClass = {
    'CoinDesk': 'source-coindesk',
    'CoinTelegraph': 'source-cointelegraph',
    'Bitcoin Magazine': 'source-btcmag',
    'Decrypt': 'source-decrypt',
  };
  list.innerHTML = items.map(function(item) {
    var dotClass = sourceDotClass[item.source] || 'source-coindesk';
    var dateStr = 'â€”';
    try {
      var d = new Date(item.pub);
      var diffMin = Math.round((Date.now() - d.getTime()) / 60000);
      if(diffMin < 60) dateStr = diffMin + 'min fa';
      else if(diffMin < 1440) dateStr = Math.round(diffMin/60) + 'h fa';
      else dateStr = Math.round(diffMin/1440) + 'g fa';
    } catch(e) { dateStr = item.pub || 'â€”'; }
    return '<div class="news-item">' +
      '<div><div class="news-source-dot ' + dotClass + '"></div></div>' +
      '<div>' +
        '<div class="news-title"><a href="' + item.link + '" target="_blank" rel="noopener">' + item.title + ' â†—</a></div>' +
        '<div class="news-meta">' +
          '<span class="news-source-badge">' + item.source + '</span>' +
          '<span class="news-date">' + dateStr + '</span>' +
        '</div>' +
        (item.summary ? '<div class="news-summary">' + item.summary + '</div>' : '') +
      '</div>' +
      '</div>';
  }).join('');
}

function filterNews(source, btn) {
  document.querySelectorAll('.filter-btn').forEach(function(b){ b.classList.remove('active'); });
  if(btn) btn.classList.add('active');
  renderNews(source);
}

function loadNews() {
  var list = document.getElementById('newsList');
  if(list) list.innerHTML = '<div style="padding:24px;text-align:center;color:var(--muted);font-style:italic;">Caricamento newsâ€¦</div>';
  fetch('/news-feed')
    .then(function(r){ return r.json(); })
    .then(function(d) {
      _allNewsItems = d.items || [];
      renderNews('all');
    })
    .catch(function(err) {
      if(list) list.innerHTML = '<div style="padding:20px;text-align:center;color:var(--red);">Errore caricamento news: ' + err.message + '</div>';
    });
}

/* â”€â”€ INIT â”€â”€ */
loadStats();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PED â€” Piano Editoriale Digitale
   Posts stored in localStorage key: 'ped_posts' (array of objects)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

var _PED_KEY = 'ped_posts';
var _PED_APIKEY = 'ped_api_key';

// Default editorial calendar â€” Mar 2026 (pre-seeded, Day 0 era)
var _PED_DEFAULTS = [
  { id: 'd1', title: 'Day 0 â€” Il Reset', date: '2026-03-01T09:00', channel: 'tg',
    photo: 'mvp-initial.png',
    text: 'ğŸ™ Day 0. Database azzerato. Tutto riparte da zero.\n\nNon perchÃ© il bot non funzionasse â€” ma perchÃ© vogliamo contare solo dati certificati, da oggi.\n\nLa rete di agenti Ã¨ pronta: wf01A â†’ wf01B â†’ Kraken â†’ Polygon.\nOgni segnale sarÃ  commesso on-chain prima del fill.\n\nIl primo trade reale del sistema "new era" viene da qui.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd2', title: 'Come Funziona il Dual-Gate', date: '2026-03-02T10:00', channel: 'tg',
    photo: 'agent-matrix.png',
    text: 'ğŸ§  Dual-gate: come il bot decide se tradare.\n\n1. LLM analizza 20+ feature: RSI, CVD, funding, orderbook, news\n2. XGBoost valida la direzione in modo indipendente\n3. Solo se entrambi concordano â†’ BET\n\nSe uno dice UP e l\'altro dice DOWN â†’ SKIP.\nNessuna esecuzione senza consensus.\n\nÃˆ un meccanismo di riduzione del rumore, non di ottimizzazione del WR.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd3', title: 'On-Chain Audit â€” PerchÃ©', date: '2026-03-03T11:00', channel: 'tg',
    photo: 'screen-header.png',
    text: 'â›“ PerchÃ© commit ogni segnale su Polygon?\n\nPerchÃ© il timestamp on-chain Ã¨ immutabile.\n\nOgni prediction ha un hash sha-256 committato su BTCBotAudit.sol PRIMA del fill Kraken.\nDopodichÃ© viene risolto con outcome + PnL reale.\n\nChiunque puÃ² verificare: il commit era PRIMA del trade?\nSe sÃ¬, non c\'Ã¨ stato cherry-picking.\n\nCosto: ~$0.46/mese. Vale ogni centesimo.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd4', title: 'Ghost Signals â€” Il Dataset Ombra', date: '2026-03-04T12:00', channel: 'tg',
    photo: 'elenco-agents.png',
    text: 'ğŸ‘» Ghost signals: le scommesse che non abbiamo fatto.\n\nOgni SKIP ha una direzione predetta â€” anche se non tradiamo.\nDepois chiudiamo il ghost: aveva ragione?\n\nDay 0: ghost WR = 63.2% su 19 osservazioni.\nQuando il bot NON tradata, vedeva la direzione giusta.\n\nQuesti dati diventano training set certificato per il prossimo retrain XGBoost.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd5', title: 'WR vs Expectancy', date: '2026-03-05T10:00', channel: 'tg',
    photo: 'screen-mobile.png',
    text: 'ğŸ“ WR al 55% non Ã¨ il punto.\n\nL\'obiettivo Ã¨ massimizzare l\'expectancy:\nE = (WR Ã— avg_win) âˆ’ ((1âˆ’WR) Ã— avg_loss)\n\nUn sistema al 45% WR con RR 3:1 batte un sistema\nal 60% WR con RR 0.8:1. Sempre.\n\nIl bot attuale: RR medio ~1.5x, soglia confidence 0.62.\nL\'edge non Ã¨ nel WR â€” Ã¨ nella qualitÃ  del segnale.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd6', title: 'Funding Rate Pattern', date: '2026-03-06T09:00', channel: 'tg',
    photo: 'capello-bitcoin.png',
    text: 'ğŸ“Š Funding rate: l\'edge che il retail non vede.\n\nQuando il funding perp Ã¨ positivo elevato (>0.05%),\ni longs pagano gli shorts ogni 8 ore.\n\nI market maker hedgiano: short spot + long perp.\nQuando il funding si azzera â†’ chiudono lo short spot â†’ buy pressure.\n\nIl bot monitora questo ciclo. Ãˆ in input a wf01A.\n\nSettlement orari: 00:00 Â· 08:00 Â· 16:00 UTC\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd7', title: 'Kelly Criterion e Sizing', date: '2026-03-07T11:00', channel: 'tg',
    photo: 'capello-bitcoin.png',
    text: 'ğŸ¯ Quanto rischiare per trade?\n\nKelly criterion: f* = (pÃ—b âˆ’ q) / b\nCon WR 55%, RR 1.5x â†’ f* â‰ˆ 11.7%\n\nIl bot usa ~2% del capitale. PerchÃ©?\nPerchÃ© siamo in fase di calibrazione del modello.\nKelly completo si usa quando hai 500+ trade certificati.\n\nConservativitÃ  ora = sopravvivenza statistica domani.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd8', title: 'La Notte del +7%', date: '2026-03-08T10:00', channel: 'tg',
    photo: 'war-room.png',
    text: 'ğŸŒ™ Una notte, +$7.22. Era il 25 Febbraio.\n\nIn una sessione di 8 ore il bot ha fatto il 7% del capitale.\nWR quella notte: 80%.\n\nMa attenzione: 113% del PnL totale di quel mese veniva da quella singola notte.\nSenza di essa: -$2 complessivi.\n\nUna sessione non Ã¨ un sistema. Per questo contiamo day per day da Day 0.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd9', title: 'Circuit Breaker', date: '2026-03-09T09:00', channel: 'tg',
    photo: 'scheduled-tasks-mac.png',
    text: 'ğŸ›¡ Circuit breaker: il bot si ferma da solo.\n\n3 trade consecutivi in loss â†’ pausa automatica.\nNessun override dall\'utente necessario.\n\nPerchÃ©? PerchÃ© 3 loss consecutive in trending market\nsuggeriscono che il regime Ã¨ cambiato.\nIl modello non deve continuare ad accumulare perdite su un segnale degradato.\n\nRiattivazione manuale via Telegram Commander.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd10', title: 'Open Source', date: '2026-03-10T10:00', channel: 'tg',
    photo: 'screenshot.png',
    text: 'ğŸ“‚ Il codice Ã¨ pubblico.\n\ngithub.com/mattiacalastri/btc_predictions\n\nTutto: Flask backend, n8n workflow exports, XGBoost training scripts, smart contract.\n\nNon perchÃ© siamo altruisti â€” perchÃ© la trasparenza Ã¨ il prodotto.\nChiunque puÃ² forkkare, verificare, migliorare.\n\nLa fiducia non si chiede. Si guadagna commit per commit.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd11', title: 'Whale Alert Coming', date: '2026-03-11T11:00', channel: 'tg',
    photo: 'agent-matrix.png',
    text: 'ğŸ¦ Il prossimo agente: Whale Alert.\n\nOgni transazione >1000 BTC ha un lag misurabile sul prezzo: 2â€“8 minuti.\nI whale si muovono, il mercato reagisce â€” ma c\'Ã¨ una finestra.\n\nStato: concept.\nPrioritÃ : alta. Il whale data Ã¨ free tier disponibile via Whale Alert API.\n\nQuando entra nel dual-gate, l\'information gain sarÃ  significativo.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd12', title: 'Regime Detection', date: '2026-03-12T10:00', channel: 'tg',
    photo: 'screen-mobile.png',
    text: 'ğŸ”® 80% del tempo BTC Ã¨ in ranging. 20% in trend.\n\nIl modello attuale non distingue i due regimi.\nUn segnale UP in ranging ha WR diverso da uno in trend.\n\nIl Regime Detector labella ogni candela: trend / ranging / volatile.\nLa label entra come feature XGBoost.\n\nPrognosi: il WR in trend supererÃ  il 65%.\nIn ranging: scenderÃ  sotto il 50%. â†’ Non tradare in ranging.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd13', title: 'Agent Marketplace â€” Visione', date: '2026-03-13T09:00', channel: 'tg',
    photo: 'satoshi-statue.png',
    text: 'ğŸ™ La visione a lungo termine: Agent Marketplace.\n\nDeveloper terzi deployano agenti specializzati.\nOgni agente Ã¨ un modulo verificabile on-chain.\nRevenue share automatico via smart contract.\n\nChi porta un agente con edge reale (validato su dati certificati) riceve una quota del PnL.\nNessuna fiducia necessaria â€” la blockchain Ã¨ l\'arbitro.\n\nETA: Q3 2026. Status: concept design.\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
  { id: 'd14', title: 'Settimana 1 â€” Riepilogo Day 0', date: '2026-03-14T10:00', channel: 'tg',
    photo: 'logo-channel.png',
    text: 'ğŸ“Š Fine settimana 1 â€” Day 0 era.\n\nBet reali: [dinamico]\nGhost WR osservato: 63.2%\nOn-chain commit: 100% coverage\nCircuit breaker: non attivato âœ…\n\nIl modello funziona. Lentamente, come deve.\nNon stiamo correndo â€” stiamo costruendo il dataset certificato.\n\nGrazie a chi segue il canale e verifica on-chain. ğŸ™\n\nbtcpredictor.io Â· ğŸ©ğŸ™ğŸª„' },
];

function pedInit() {
  // Init API key bar visibility
  var saved = localStorage.getItem(_PED_APIKEY);
  var bar = document.getElementById('pedApikeyBar');
  if(bar) bar.style.display = saved ? 'none' : 'flex';
  if(saved) {
    var status = document.getElementById('pedApikeyStatus');
    if(status) status.textContent = 'âœ… chiave salvata';
  }
  // Seed default posts if empty
  if(!localStorage.getItem(_PED_KEY)) {
    localStorage.setItem(_PED_KEY, JSON.stringify(_PED_DEFAULTS));
  }
  pedRenderPosts();
}

function pedGetPosts() {
  try { return JSON.parse(localStorage.getItem(_PED_KEY)) || []; }
  catch(e) { return []; }
}

function pedSavePosts(posts) {
  localStorage.setItem(_PED_KEY, JSON.stringify(posts));
}

function pedRenderPosts() {
  var list = document.getElementById('pedPostsList');
  if(!list) return;
  var posts = pedGetPosts();
  if(!posts.length) {
    list.innerHTML = '<div class="ped-empty">Nessun post in bozza. Crea il primo con "+ Nuovo Post".</div>';
    return;
  }
  list.innerHTML = posts.map(function(p) {
    var chanBadge = '';
    if(p.channel === 'tg')  chanBadge = '<span class="post-chan-badge post-chan-tg">âœˆï¸ TG</span>';
    else if(p.channel === 'x')  chanBadge = '<span class="post-chan-badge post-chan-x">ğ• X</span>';
    else if(p.channel === 'li') chanBadge = '<span class="post-chan-badge post-chan-li">ğŸ’¼ LI</span>';
    else if(p.channel === 'rd') chanBadge = '<span class="post-chan-badge post-chan-rd">ğŸ¤– RD</span>';
    else chanBadge = '<span class="post-chan-badge post-chan-tg">âœˆï¸ TG</span><span class="post-chan-badge post-chan-x" style="margin-left:4px;">ğ• X</span>';
    var dt = p.date ? new Date(p.date).toLocaleString('it-IT',{day:'2-digit',month:'short',hour:'2-digit',minute:'2-digit'}) : 'â€”';
    var canTG = (p.channel === 'tg' || p.channel === 'all');
    var safeId = String(p.id).replace(/[^a-zA-Z0-9_\-]/g,'_');
    var photoThumb = p.photo ? '<div class="post-photo-thumb"><img src="/static/marketing_assets/' + escHtml(p.photo) + '" alt="" loading="lazy"><span class="post-photo-name">ğŸ–¼ ' + escHtml(p.photo) + '</span></div>' : '';
    var tgLabel = p.photo ? 'ğŸ–¼ Invia con foto' : 'âœˆï¸ Pubblica su Telegram';
    return '<div class="post-card" id="pcard_' + safeId + '">' +
      '<div class="post-card-meta">' +
        '<span class="post-date-badge">ğŸ“… ' + dt + '</span>' +
        chanBadge +
      '</div>' +
      photoThumb +
      '<div class="post-title">' + escHtml(p.title || '') + '</div>' +
      '<div class="post-text" id="ptext_' + safeId + '">' + escHtml(p.text || '') + '</div>' +
      '<span class="post-text-toggle" onclick="pedToggleExpand(\'' + safeId + '\')">â–¼ leggi tutto</span>' +
      '<div class="post-actions">' +
        '<button class="btn-pub btn-pub-copy" onclick="pedCopyPost(\'' + safeId + '\')">ğŸ“‹ Copia</button>' +
        (canTG ? '<button class="btn-pub btn-pub-tg" onclick="pedPublishTG(\'' + safeId + '\')">' + tgLabel + '</button>' : '') +
        '<button class="btn-pub btn-pub-x" disabled title="Richiede X Basic tier">ğ• X â€” coming soon</button>' +
        '<button class="btn-pub btn-pub-li" disabled title="Integrazione in arrivo">ğŸ’¼ LinkedIn</button>' +
        '<button class="btn-pub btn-pub-rd" disabled title="Integrazione in arrivo">ğŸ¤– Reddit</button>' +
        '<button class="btn-pub btn-pub-del" onclick="pedDeletePost(\'' + safeId + '\')" style="margin-left:auto;">ğŸ—‘</button>' +
      '</div>' +
    '</div>';
  }).join('');
}

function escHtml(s) {
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function pedToggleExpand(id) {
  var el = document.getElementById('ptext_' + id);
  var tog = el && el.nextElementSibling;
  if(!el) return;
  var expanded = el.classList.toggle('expanded');
  if(tog) tog.textContent = expanded ? 'â–² chiudi' : 'â–¼ leggi tutto';
}

function pedCopyPost(id) {
  var posts = pedGetPosts();
  var p = posts.find(function(x){ return String(x.id).replace(/[^a-zA-Z0-9_\-]/g,'_') === id; });
  if(!p) return;
  navigator.clipboard.writeText(p.text || '').then(function() {
    pedShowToast('ğŸ“‹ Testo copiato!', false);
  }).catch(function() {
    pedShowToast('âš  Errore clipboard', true);
  });
}

function pedPublishTG(id) {
  var apiKey = localStorage.getItem(_PED_APIKEY);
  if(!apiKey) {
    var bar = document.getElementById('pedApikeyBar');
    if(bar) bar.style.display = 'flex';
    pedShowToast('âš  Inserisci prima la API Key', true);
    return;
  }
  var posts = pedGetPosts();
  var p = posts.find(function(x){ return String(x.id).replace(/[^a-zA-Z0-9_\-]/g,'_') === id; });
  if(!p) return;
  var btnEl = document.querySelector('#pcard_' + id + ' .btn-pub-tg');
  if(btnEl) { btnEl.textContent = 'â³ Invioâ€¦'; btnEl.disabled = true; }
  fetch('/publish-telegram', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json', 'X-Api-Key': apiKey },
    body: JSON.stringify({ text: p.text, parse_mode: 'HTML', photo: p.photo || null })
  }).then(function(r){ return r.json(); })
    .then(function(d) {
      if(d.ok) {
        pedShowToast('âœ… Pubblicato su Telegram! msg_id ' + d.message_id, false);
        if(btnEl) { btnEl.textContent = 'âœ… Inviato'; }
        // Mark as sent
        p.sent_tg = true;
        pedSavePosts(posts);
      } else {
        pedShowToast('âŒ Errore TG: ' + (d.error || 'unknown'), true);
        if(btnEl) { btnEl.textContent = 'âœˆï¸ Pubblica su Telegram'; btnEl.disabled = false; }
      }
    }).catch(function(err) {
      pedShowToast('âŒ Errore rete: ' + err.message, true);
      if(btnEl) { btnEl.textContent = 'âœˆï¸ Pubblica su Telegram'; btnEl.disabled = false; }
    });
}

function pedDeletePost(id) {
  if(!confirm('Eliminare questo post?')) return;
  var posts = pedGetPosts().filter(function(p){ return String(p.id).replace(/[^a-zA-Z0-9_\-]/g,'_') !== id; });
  pedSavePosts(posts);
  pedRenderPosts();
}

function pedSaveApiKey() {
  var val = (document.getElementById('pedApikeyInput').value || '').trim();
  if(!val) { pedShowToast('âš  API Key vuota', true); return; }
  localStorage.setItem(_PED_APIKEY, val);
  document.getElementById('pedApikeyBar').style.display = 'none';
  pedShowToast('âœ… API Key salvata', false);
}

function pedToggleNewForm() {
  var f = document.getElementById('pedNewForm');
  if(!f) return;
  var show = f.style.display === 'none';
  f.style.display = show ? 'block' : 'none';
  if(show) {
    // default datetime = now + 1h rounded to next :00
    var d = new Date(); d.setHours(d.getHours() + 1); d.setMinutes(0); d.setSeconds(0);
    var pad = function(n){ return String(n).padStart(2,'0'); };
    document.getElementById('pedFormDate').value =
      d.getFullYear() + '-' + pad(d.getMonth()+1) + '-' + pad(d.getDate()) + 'T' + pad(d.getHours()) + ':00';
    document.getElementById('pedFormTitle').focus();
  }
}

function pedSaveNewPost() {
  var title = (document.getElementById('pedFormTitle').value || '').trim();
  var date  = document.getElementById('pedFormDate').value;
  var chan  = document.getElementById('pedFormChannel').value;
  var text  = (document.getElementById('pedFormText').value || '').trim();
  if(!text) { pedShowToast('âš  Testo obbligatorio', true); return; }
  var posts = pedGetPosts();
  var newPost = { id: 'p' + Date.now(), title: title || 'Post ' + new Date().toLocaleDateString('it-IT'), date: date, channel: chan, text: text };
  posts.unshift(newPost);
  pedSavePosts(posts);
  pedRenderPosts();
  pedToggleNewForm();
  document.getElementById('pedFormTitle').value = '';
  document.getElementById('pedFormText').value  = '';
  pedShowToast('âœ… Post salvato in bozza', false);
}

function pedShowToast(msg, isErr) {
  var t = document.getElementById('pedToast');
  if(!t) {
    t = document.createElement('div');
    t.id = 'pedToast'; t.className = 'pub-toast';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.className = 'pub-toast' + (isErr ? ' err' : '');
  setTimeout(function(){ t.classList.add('show'); }, 10);
  setTimeout(function(){ t.classList.remove('show'); }, 3200);
}

// Init PED on load
pedInit();
</script>
</body>
</html>
